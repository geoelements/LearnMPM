
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>1D vibration of a single material point &#8212; Learn MPM</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Axial vibration of a 1D bar" href="axial-vibration1d.html" />
    <link rel="prev" title="Welcome to learn MPM with Python" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Learn MPM</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to learn MPM with Python
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1D vibration of a single material point
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="axial-vibration1d.html">
   Axial vibration of a 1D bar
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="mpm-code.html">
   Coding 1D MPM
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="learnmpm-axial-vibration1d.html">
     Axial vibration of 1D bar using LearnMPM
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/geoelements/learn-mpm/main?urlpath=lab/tree/docs/point-axial-vibration1d.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/geoelements/learn-mpm/blob/main/docs/point-axial-vibration1d.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/geoelements/learn-mpm"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/geoelements/learn-mpm/issues/new?title=Issue%20on%20page%20%2Fpoint-axial-vibration1d.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/point-axial-vibration1d.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analytical-solution">
   Analytical solution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-mpm-code-usl-scheme">
   1D MPM code - USL Scheme
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialization-phase">
     1. Initialization phase
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computational-domain">
       Computational domain
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#material-properties">
       Material properties
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#initial-loading-conditions">
       Initial loading conditions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#material-points">
       Material points
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#shape-functions">
       Shape functions
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#shape-function-for-material-point">
         Shape function for material point
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-phase-for-time-step-t-to-t-delta-t">
     2. Solution phase for time step
     <span class="math notranslate nohighlight">
      \(t\)
     </span>
     to
     <span class="math notranslate nohighlight">
      \(t + \Delta t\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#map-mass-and-momentum-to-nodes">
       Map mass and momentum to nodes
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#applying-boundary-condition">
       Applying boundary condition
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-nodal-forces">
       Compute nodal forces
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-external-forces">
       Compute external forces
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-internal-forces">
       Compute internal forces
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculate-the-total-unbalanced-nodal-forces">
       Calculate the total unbalanced nodal forces
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#update-nodal-momentum">
     Update nodal momentum
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#critical-time-step">
       Critical time step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mapping-from-nodes-to-particles">
     Mapping from nodes to particles
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#update-particle-velocities-and-position">
       Update particle velocities and position
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#update-particle-momentum">
       Update particle momentum
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#update-nodal-velocity">
       Update nodal velocity
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-strains-and-stresses">
       Compute strains and stresses
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-mpm-code-complete">
   1D MPM code complete
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-results-of-mpm-and-analytical-solution">
     Plot results of MPM and analytical solution
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>1D vibration of a single material point</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analytical-solution">
   Analytical solution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-mpm-code-usl-scheme">
   1D MPM code - USL Scheme
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialization-phase">
     1. Initialization phase
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computational-domain">
       Computational domain
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#material-properties">
       Material properties
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#initial-loading-conditions">
       Initial loading conditions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#material-points">
       Material points
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#shape-functions">
       Shape functions
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#shape-function-for-material-point">
         Shape function for material point
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution-phase-for-time-step-t-to-t-delta-t">
     2. Solution phase for time step
     <span class="math notranslate nohighlight">
      \(t\)
     </span>
     to
     <span class="math notranslate nohighlight">
      \(t + \Delta t\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#map-mass-and-momentum-to-nodes">
       Map mass and momentum to nodes
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#applying-boundary-condition">
       Applying boundary condition
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-nodal-forces">
       Compute nodal forces
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-external-forces">
       Compute external forces
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-internal-forces">
       Compute internal forces
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculate-the-total-unbalanced-nodal-forces">
       Calculate the total unbalanced nodal forces
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#update-nodal-momentum">
     Update nodal momentum
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#critical-time-step">
       Critical time step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mapping-from-nodes-to-particles">
     Mapping from nodes to particles
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#update-particle-velocities-and-position">
       Update particle velocities and position
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#update-particle-momentum">
       Update particle momentum
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#update-nodal-velocity">
       Update nodal velocity
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compute-strains-and-stresses">
       Compute strains and stresses
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-mpm-code-complete">
   1D MPM code complete
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-results-of-mpm-and-analytical-solution">
     Plot results of MPM and analytical solution
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="d-vibration-of-a-single-material-point">
<h1>1D vibration of a single material point<a class="headerlink" href="#d-vibration-of-a-single-material-point" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/geoelements/learn-mpm/blob/main/book/bar1d-vibration.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<a class="reference external" href="https://jupyter.designsafe-ci.org/user/name/notebooks/CommunityData/Use%20Case%20Products/MPM/LearnMPM/point-axial-vibration1d.ipynb"><img alt="Try on DesignSafe" src="https://img.shields.io/badge/Open%20in-DesignSafe-blue.svg?logo=data:image/png%3Bbase64,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" /></a></p>
<p>Let us consider the vibration of a single material point as shown below. The bar is represented by a single point initially located at <span class="math notranslate nohighlight">\(x_p = L/2\)</span>, which has an initial velocity <span class="math notranslate nohighlight">\(v_0\)</span>. The material is linear elastic.</p>
<p><img alt="bar1d" src="_images/bar1d.png" /></p>
<p>The exact solution for the velocity is: <span class="math notranslate nohighlight">\(v(t) = v_0 \cos (\omega t), \quad \omega = \frac{1}{L}\sqrt{E/\rho}\)</span></p>
<p>and for the position is: <span class="math notranslate nohighlight">\(x(t) = x_0 \exp \left[\frac{v_0}{L \omega} \sin (\omega t)\right]\)</span></p>
<p>The bar has a constant density <span class="math notranslate nohighlight">\(\rho = 1.0\)</span>. The constitutive equation is <span class="math notranslate nohighlight">\(\dot\sigma = E \dot \varepsilon\)</span>, where <span class="math notranslate nohighlight">\(\dot \varepsilon = dv/dx\)</span> and <span class="math notranslate nohighlight">\(E\)</span> is the Young’s modulus. The mesh consists of a single two-noded element. The elastic wave speed is <span class="math notranslate nohighlight">\(c = \sqrt{E/\rho} = 2 \pi\)</span>. The boundary conditions are imposed on the mesh, both the nodal velocity and the acceleration at <span class="math notranslate nohighlight">\(x = 0\)</span> (the left node) is zero throughout the simulation.</p>
<section id="analytical-solution">
<h2>Analytical solution<a class="headerlink" href="#analytical-solution" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Analytical solution</span>
<span class="k">def</span> <span class="nf">analytical_vibration</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">x_loc</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
    <span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">tt</span><span class="p">,</span> <span class="n">vt</span><span class="p">,</span> <span class="n">xt</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>
        <span class="n">omega</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E</span> <span class="o">/</span> <span class="n">rho</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x_loc</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">v0</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span> <span class="o">*</span> <span class="n">omega</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>
        <span class="n">vt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">xt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">tt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
    <span class="k">return</span> <span class="n">tt</span><span class="p">,</span> <span class="n">vt</span><span class="p">,</span> <span class="n">xt</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s now plot the analytical solution of a vibrating bar at the end of the bar <span class="math notranslate nohighlight">\(x = 1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Young&#39;s modulus</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># analytical solution at the end of the bar</span>
<span class="n">ta</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="n">xa</span> <span class="o">=</span> <span class="n">analytical_vibration</span><span class="p">(</span><span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="p">,</span> <span class="n">rho</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v0</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">x_loc</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">duration</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytical&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;velocity (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/point-axial-vibration1d_6_0.png" src="_images/point-axial-vibration1d_6_0.png" />
</div>
</div>
</section>
<section id="d-mpm-code-usl-scheme">
<h2>1D MPM code - USL Scheme<a class="headerlink" href="#d-mpm-code-usl-scheme" title="Permalink to this headline">#</a></h2>
<p>We will use the Update Stress Last (USL) algorithm to implement the 1D vibrating bar example. An overview of the USL MPM algorithm is shown below:</p>
<ol>
<li><p>Initialisation phase</p>
<p>(a) Particle distribution in the undeformed configuration</p>
<p>(b) Grid set up</p>
<p>(c) Initialise particle quantities such as mass, stress, strain, etc.</p>
</li>
<li><p>Solution phase for time step <span class="math notranslate nohighlight">\(t\)</span> to <span class="math notranslate nohighlight">\(t + \Delta t\)</span></p>
<p>(a) Mapping from particles to nodes</p>
<p>i. Compute nodal mass: <span class="math notranslate nohighlight">\(m_i^t = \sum\limits_{p=1}^{n_P} N_i(\textbf{x}_p^t) m_p\)</span></p>
<p>ii. Compute nodal momentum: <span class="math notranslate nohighlight">\((m \textbf{v})_i^{t} = \sum\limits_{p=1}^{n_P} N_i(\textbf{x}_p^t) m_p \textbf{v}_p^{t}\)</span></p>
<p>iii. Compute external force: <span class="math notranslate nohighlight">\( (\textbf{f}_i)^{ext,t} = \textbf{b}_i^{t} + \textbf{t}_i^{t} \)</span></p>
<p>iv. Compute internal force <span class="math notranslate nohighlight">\( (\textbf{f}_i)^{int,t} = \sum\limits_{p=1}^{n_P} V_p^t B_i(\textbf{x}_p^t) \boldsymbol{\sigma}_p^{t} \)</span></p>
<p>v. Compute nodal force: <span class="math notranslate nohighlight">\( (\textbf{f}_i)^{tot,t} = (\textbf{f}_i)^{ext,t} + (\textbf{f}_i)^{int,t}\)</span></p>
<p>(b) Update momenta: <span class="math notranslate nohighlight">\((m \textbf{v})_i^{t + \Delta t} = (m \textbf{v})_i^{t} +  \textbf{f}_i^{tot,t} * \Delta t\)</span></p>
<p>(c) Mapping from nodes to particles</p>
<p>i. Update material point velocity: <span class="math notranslate nohighlight">\( \textbf{v}_p^{t+\Delta t} = \sum\limits_{i=1}^{n_n} N_i(\textbf{x}_p^t) \textbf{v}_i^{t+\Delta t} \)</span></p>
<p>ii. Update material point position: <span class="math notranslate nohighlight">\( \textbf{x}_p^{t+\Delta t} = \textbf{x}_p^t + \textbf{v}_p^{t+\Delta t} *  \Delta t\)</span></p>
<p>iii. Update nodal velocities: <span class="math notranslate nohighlight">\(\textbf{v}_i^{t + \Delta t} = (m \textbf{v})_i^{t + \Delta t} / m_i^{t}\)</span></p>
<p>iv. Calculate strain rate: <span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon}_p^t = \sum\limits_{p=1}^{n_P} B_i(\textbf{x}_p^t) \textbf{v}_i^t \)</span></p>
<p>v. Compute incremental stress based on a constitutive model <span class="math notranslate nohighlight">\( \Delta\boldsymbol{\sigma}_p^t= \mathbf{D} : \Delta \boldsymbol{\varepsilon}_p^t \)</span>.</p>
<p>vi. Compute updated stress at each material point: <span class="math notranslate nohighlight">\( \boldsymbol{\sigma}_p^t = \boldsymbol{\sigma}_p^{t-\Delta t} + \Delta \boldsymbol{\sigma}_p^t \)</span></p>
</li>
<li><p>Reset the grid and advance to the next step</p></li>
</ol>
<section id="initialization-phase">
<h3>1. Initialization phase<a class="headerlink" href="#initialization-phase" title="Permalink to this headline">#</a></h3>
<section id="computational-domain">
<h4>Computational domain<a class="headerlink" href="#computational-domain" title="Permalink to this headline">#</a></h4>
<p>Let’s now develop a 1D MPM code for bar vibration with a single material point in the middle of the element.</p>
<p><img alt="1d bar" src="_images/bar1dmpm.png" /></p>
<p>The domain (bar) has a length of 1 m. We descritize the bar using a single linear element with two nodes. The left node is at 0 and the right node is at the end of the bar at L.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># Computational grid</span>
<span class="n">L</span>          <span class="o">=</span> <span class="mi">1</span>                       <span class="c1"># domain size</span>
<span class="n">nodes</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">])</span>        <span class="c1"># nodal coordinates</span>
<span class="n">nnodes</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>              <span class="c1"># number of nodes</span>
<span class="n">nelements</span>  <span class="o">=</span> <span class="mi">1</span>                       <span class="c1"># number of elements</span>
<span class="n">nparticles</span> <span class="o">=</span> <span class="mi">1</span>                       <span class="c1"># number of particles</span>
<span class="n">el_length</span>  <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">nelements</span>           <span class="c1"># element length</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of elements: </span><span class="si">{}</span><span class="s2"> nodal coordinates: </span><span class="si">{}</span><span class="s2">, nnodes: </span><span class="si">{}</span><span class="s2"> nparticles: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span>
        <span class="nb">format</span><span class="p">(</span><span class="n">nelements</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">nnodes</span><span class="p">,</span> <span class="n">nparticles</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of elements: 1 nodal coordinates: [0 1], nnodes: 2 nparticles: 1
</pre></div>
</div>
</div>
</div>
</section>
<section id="material-properties">
<h4>Material properties<a class="headerlink" href="#material-properties" title="Permalink to this headline">#</a></h4>
<p>We now define a linear elastic material with <span class="math notranslate nohighlight">\(E = 2 * \pi^2\)</span> and a density <span class="math notranslate nohighlight">\(\rho = 1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Material property</span>
<span class="n">E</span>          <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>          <span class="c1"># Young&#39;s modulus</span>
<span class="n">rho</span>        <span class="o">=</span> <span class="mf">1.</span>                      <span class="c1"># Density</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initial-loading-conditions">
<h4>Initial loading conditions<a class="headerlink" href="#initial-loading-conditions" title="Permalink to this headline">#</a></h4>
<p>We apply an initial velocity <span class="math notranslate nohighlight">\(v_0 = 0.1\)</span> at the material point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial conditions </span>
<span class="n">v0</span>         <span class="o">=</span> <span class="mf">0.1</span>                     <span class="c1"># initial velocity</span>
<span class="n">x_loc</span>      <span class="o">=</span> <span class="mf">0.5</span>                     <span class="c1"># location to get analytical solution</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="material-points">
<h4>Material points<a class="headerlink" href="#material-points" title="Permalink to this headline">#</a></h4>
<p>In MPM, the material points keep track of the position, mass, velocity, volume, momentum and stress. The material point is at the middle of the element. The volume of the material point is the size of the entire length of the bar. Assuming a density <span class="math notranslate nohighlight">\(\rho = 1\)</span>, the mass of the material point is <span class="math notranslate nohighlight">\(\rho * L = 1 * 1 = 1.0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Material points</span>
<span class="n">x_p</span>        <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">el_length</span>         <span class="c1"># position</span>
<span class="n">mass_p</span>     <span class="o">=</span> <span class="mf">1.</span>                      <span class="c1"># mass</span>
<span class="n">vol_p</span>      <span class="o">=</span> <span class="n">el_length</span> <span class="o">/</span> <span class="n">nparticles</span>  <span class="c1"># volume</span>
<span class="n">vel_p</span>      <span class="o">=</span> <span class="n">v0</span>                      <span class="c1"># velocity</span>
<span class="n">stress_p</span>   <span class="o">=</span> <span class="mf">0.</span>                      <span class="c1"># stress</span>
<span class="n">mv_p</span>       <span class="o">=</span> <span class="n">mass_p</span> <span class="o">*</span> <span class="n">vel_p</span>          <span class="c1"># momentum = m * v</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="shape-functions">
<h4>Shape functions<a class="headerlink" href="#shape-functions" title="Permalink to this headline">#</a></h4>
<p>We will use a two-noded single element with linear elements. In order to avoid finding the natural coordinates of material points, we define the shape functions in the global coordinate system. In 1D, the shape functions are defined as:</p>
<p><span class="math notranslate nohighlight">\(N_i (x) = \begin{cases} 1 - |x - x_i|/l &amp; \text{if } | x - x_i| \le l \\ 0 &amp; \text{else}  \end{cases}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(l\)</span> denotes the element size.</p>
<p>The following listings show the general shape functions and gradients for an element.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">])</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>

<span class="c1"># shape function</span>
<span class="n">n1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">L</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="n">n2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">L</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;N1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;N2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;element&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;N(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/point-axial-vibration1d_17_0.png" src="_images/point-axial-vibration1d_17_0.png" />
</div>
</div>
<p>The derivative of the shape function is:</p>
<p><span class="math notranslate nohighlight">\(B (x) = [-1/l_x, 1/l_x]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">])</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>

<span class="c1"># shape function</span>
<span class="n">b1</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">L</span> <span class="k">for</span> <span class="n">x_p</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>
<span class="n">b2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">L</span> <span class="k">for</span> <span class="n">x_p</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;B1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;B2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;element&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;B(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/point-axial-vibration1d_19_0.png" src="_images/point-axial-vibration1d_19_0.png" />
</div>
</div>
<section id="shape-function-for-material-point">
<h5>Shape function for material point<a class="headerlink" href="#shape-function-for-material-point" title="Permalink to this headline">#</a></h5>
<p>We will now define the shape function and its derivatives for the material point located at <span class="math notranslate nohighlight">\(x_p\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># shape function and derivative</span>
<span class="n">N</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">L</span><span class="p">])</span>
<span class="n">dN</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">L</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape function for material point at x_p = 0.5, is N: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gradient of shape function for material point at x_p = 0.5, is B: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dN</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape function for material point at x_p = 0.5, is N: [0.5 0.5]
Gradient of shape function for material point at x_p = 0.5, is B: [-1.  1.]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="solution-phase-for-time-step-t-to-t-delta-t">
<h3>2. Solution phase for time step <span class="math notranslate nohighlight">\(t\)</span> to <span class="math notranslate nohighlight">\(t + \Delta t\)</span><a class="headerlink" href="#solution-phase-for-time-step-t-to-t-delta-t" title="Permalink to this headline">#</a></h3>
<section id="map-mass-and-momentum-to-nodes">
<h4>Map mass and momentum to nodes<a class="headerlink" href="#map-mass-and-momentum-to-nodes" title="Permalink to this headline">#</a></h4>
<p>Mapping from particles to nodes. Let’s compute the nodal mass and momentum using the linear shape functions to map  mass and velocity of the material point.</p>
<p>Compute nodal mass: <span class="math notranslate nohighlight">\(m_i^t = \sum\limits_{p=1}^{n_P} N_i(\textbf{x}_p^t) m_p\)</span></p>
<p>Compute nodal momentum: <span class="math notranslate nohighlight">\((m \textbf{v})_i^{t} = \sum\limits_{p=1}^{n_P} N_i(\textbf{x}_p^t) m_p \textbf{v}_p^{t}\)</span></p>
<p>where,</p>
<p><span class="math notranslate nohighlight">\(m_p^t\)</span> mass of the material point <span class="math notranslate nohighlight">\(p\)</span> at time <span class="math notranslate nohighlight">\(t\)</span></p>
<p><span class="math notranslate nohighlight">\(m\textbf{v}_p^t\)</span> momentum of the material point <span class="math notranslate nohighlight">\(p\)</span> at time <span class="math notranslate nohighlight">\(t\)</span></p>
<p><span class="math notranslate nohighlight">\(n_p\)</span> total number of material points in the body</p>
<p><span class="math notranslate nohighlight">\(m_i^t\)</span> mass of node <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t\)</span></p>
<p><span class="math notranslate nohighlight">\(m\textbf{v}_i^t\)</span> momentum of node <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t\)</span></p>
<p><span class="math notranslate nohighlight">\(N_i (\textbf{x}_p^t)\)</span> shape function that maps node <span class="math notranslate nohighlight">\(i\)</span> to material point <span class="math notranslate nohighlight">\(p\)</span> and vice versa with independent
variable of the location of each material point at time <span class="math notranslate nohighlight">\(t\)</span></p>
<p><span class="math notranslate nohighlight">\(B_i (\textbf{x}_p^t)\)</span> gradient of the shape function that maps node <span class="math notranslate nohighlight">\(i\)</span> to material point <span class="math notranslate nohighlight">\(p\)</span> and vice versa such that <span class="math notranslate nohighlight">\(B = \frac{dN}{d\textbf{x}}\)</span>.</p>
<hr class="docutils" />
<p>Here, we map the mass of the particle <code class="docutils literal notranslate"><span class="pre">mass_p</span></code> and its momentum <code class="docutils literal notranslate"><span class="pre">mv_p</span></code> to both the nodes 0 and 1 of the element. The code below is equivalent to doing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mass_node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">mass_p</span>
<span class="n">mass_node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">mass_p</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># map particle mass and momentum to nodes</span>
<span class="n">mass_n</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">mass_p</span>
<span class="n">mv_n</span>   <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">mv_p</span>
</pre></div>
</div>
</div>
</div>
<p>The mass of the particle 1.0, is split equally between both the nodes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mapped mass at the nodes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mass_n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mapped mass at the nodes: [0.5 0.5]
</pre></div>
</div>
</div>
</div>
<p>Similarly, the momentum of the particle, calculated as <span class="math notranslate nohighlight">\(m_p * v_p\)</span> is split evenly between the nodes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Momentum at nodes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mv_n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Momentum at nodes: [0.05 0.05]
</pre></div>
</div>
</div>
</div>
</section>
<section id="applying-boundary-condition">
<h4>Applying boundary condition<a class="headerlink" href="#applying-boundary-condition" title="Permalink to this headline">#</a></h4>
<p>Since the left node is fixed, we constrain the velocity at the node <span class="math notranslate nohighlight">\(v_n = 0\)</span> for node 0. As we store momentum, rather than the velocity at the node, we constrain the momentum on the left node to be zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># apply boundary condition: velocity at left node is zero</span>
<span class="n">mv_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Momentum at nodes after apply BCs: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mv_n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Momentum at nodes after apply BCs: [0.   0.05]
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-nodal-forces">
<h4>Compute nodal forces<a class="headerlink" href="#compute-nodal-forces" title="Permalink to this headline">#</a></h4>
</section>
<section id="compute-external-forces">
<h4>Compute external forces<a class="headerlink" href="#compute-external-forces" title="Permalink to this headline">#</a></h4>
<p><span class="math notranslate nohighlight">\( (\textbf{f}_i)^{ext,t} = \textbf{b}_i^{t} + \textbf{t}_i^{t} \)</span></p>
<p>where,</p>
<p><span class="math notranslate nohighlight">\(\textbf{f}_i^{ext,t}\)</span> nodal external force of node <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t\)</span></p>
<p><span class="math notranslate nohighlight">\(\textbf{b}_i^t\)</span> body force of node <span class="math notranslate nohighlight">\(i\)</span></p>
<p><span class="math notranslate nohighlight">\(\textbf{f}_i^t\)</span> nodal force of node <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t\)</span></p>
<p>In this problem, there is no external force, so we set the external forces at both nodes to be zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># external force at nodes</span>
<span class="n">f_ext_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;External forces at the nodes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f_ext_n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>External forces at the nodes: [0 0]
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-internal-forces">
<h4>Compute internal forces<a class="headerlink" href="#compute-internal-forces" title="Permalink to this headline">#</a></h4>
<p>The internal force at the nodes is mapped from the particle stress:</p>
<p><span class="math notranslate nohighlight">\( (\textbf{f}_i)^{int,t} = \sum\limits_{p=1}^{n_P} V_p^t B_i(\textbf{x}_p^t) \boldsymbol{\sigma}_p^{t} \)</span></p>
<p>where,</p>
<p><span class="math notranslate nohighlight">\(\textbf{f}_i^{int,t}\)</span> nodal internal force of node <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t\)</span></p>
<p><span class="math notranslate nohighlight">\(V_p\)</span> volume at material points <span class="math notranslate nohighlight">\(p\)</span></p>
<p><span class="math notranslate nohighlight">\(B_i (\textbf{x}_p^t)\)</span> gradient of the shape function that maps node <span class="math notranslate nohighlight">\(i\)</span> to material point <span class="math notranslate nohighlight">\(p\)</span> and vice versa such that <span class="math notranslate nohighlight">\(B = \frac{dN}{d\textbf{x}}\)</span></p>
<p><span class="math notranslate nohighlight">\(\boldsymbol{\sigma}_p^t\)</span> stress of material point <span class="math notranslate nohighlight">\(p\)</span> at time <span class="math notranslate nohighlight">\(t\)</span></p>
<hr class="docutils" />
<p>At the start of the time step, <span class="math notranslate nohighlight">\(t = 0\)</span>, the body is unstressed <span class="math notranslate nohighlight">\(\sigma = 0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute internal force at nodes</span>
<span class="n">f_int_n</span> <span class="o">=</span> <span class="o">-</span> <span class="n">dN</span> <span class="o">*</span> <span class="n">vol_p</span> <span class="o">*</span> <span class="n">stress_p</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Internal forces at the nodes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f_ext_n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Internal forces at the nodes: [0 0]
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-the-total-unbalanced-nodal-forces">
<h4>Calculate the total unbalanced nodal forces<a class="headerlink" href="#calculate-the-total-unbalanced-nodal-forces" title="Permalink to this headline">#</a></h4>
<p>The total unbalanced force at the node: <span class="math notranslate nohighlight">\( \textbf{f}_i^{tot,t} = \textbf{f}_i^{int,t} + \textbf{f}_i^{ext,t}\)</span></p>
<hr class="docutils" />
<p>For this problem, the external force is zero, so the total force must equal the internal force.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># total forces at nodes</span>
<span class="n">f_total_n</span> <span class="o">=</span> <span class="n">f_int_n</span> <span class="o">+</span> <span class="n">f_ext_n</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total forces at the nodes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f_total_n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total forces at the nodes: [0. 0.]
</pre></div>
</div>
</div>
</div>
<p>We apply boundary condition on the left node, which is fixed (the velocity and acceleration are zero). Hence, we set the total force <span class="math notranslate nohighlight">\(f = m * a = 0\)</span>, since <span class="math notranslate nohighlight">\(a = 0\)</span> at the node.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># apply boundary condition: left node has no acceleration (f = m * a, and a = 0)</span>
<span class="n">f_total_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total forces at the nodes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f_total_n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total forces at the nodes: [0. 0.]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="update-nodal-momentum">
<h3>Update nodal momentum<a class="headerlink" href="#update-nodal-momentum" title="Permalink to this headline">#</a></h3>
<p>Nodal momentum: <span class="math notranslate nohighlight">\( (m\textbf{v})_i^{t+\Delta t} = (m\textbf{v})_i^t + \textbf{f}_i^{tot,t} * \Delta t\)</span></p>
<section id="critical-time-step">
<h4>Critical time step<a class="headerlink" href="#critical-time-step" title="Permalink to this headline">#</a></h4>
<p>The time step <span class="math notranslate nohighlight">\(\Delta t\)</span> must be smaller than the critical time step <span class="math notranslate nohighlight">\(\Delta t_{crit}\)</span>. Typically, <span class="math notranslate nohighlight">\(\Delta t = \Delta t_{crit}/10\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\Delta t_{crit} = \frac{L}{\sqrt{E \cdot \rho}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># critical time step</span>
<span class="n">dt_crit</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">rho</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Critical time step for an explicit simulation: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt_crit</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Critical time step for an explicit simulation: 0.15915494309189535
</pre></div>
</div>
</div>
</div>
<p>We use a time step <span class="math notranslate nohighlight">\(\Delta t\)</span> of 0.01.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># update nodal momentum</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span> 
<span class="n">mv_n</span> <span class="o">+=</span> <span class="n">f_total_n</span> <span class="o">*</span> <span class="n">dt</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Momentum at nodes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mv_n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Momentum at nodes: [0.   0.05]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="mapping-from-nodes-to-particles">
<h3>Mapping from nodes to particles<a class="headerlink" href="#mapping-from-nodes-to-particles" title="Permalink to this headline">#</a></h3>
<section id="update-particle-velocities-and-position">
<h4>Update particle velocities and position<a class="headerlink" href="#update-particle-velocities-and-position" title="Permalink to this headline">#</a></h4>
<p>Update the position of the material points based on the nodal velocity.</p>
<ul class="simple">
<li><p>Material point velocity:
<span class="math notranslate nohighlight">\( \textbf{v}_p^{t+\Delta t} = \sum\limits_{i=1}^{n_n} N_i(\textbf{x}_p^t) \textbf{v}_i^{t+\Delta t} \)</span></p></li>
<li><p>Material point position:
<span class="math notranslate nohighlight">\( \textbf{x}_p^{t+\Delta t} = \textbf{x}_p^t + \textbf{v}_p^{t+\Delta t} *  \Delta t\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># update particle position and velocity</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nnodes</span><span class="p">):</span>
    <span class="n">vel_p</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">f_total_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">mass_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">x_p</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">mv_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">mass_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Velocity of particle: </span><span class="si">{}</span><span class="s2"> and position: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vel_p</span><span class="p">,</span> <span class="n">x_p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Velocity of particle: 0.1 and position: 0.5005
</pre></div>
</div>
</div>
</div>
</section>
<section id="update-particle-momentum">
<h4>Update particle momentum<a class="headerlink" href="#update-particle-momentum" title="Permalink to this headline">#</a></h4>
<p>Material point momentum: <span class="math notranslate nohighlight">\( (m\textbf{v})_p^{t+\Delta t} = m_p * \textbf{v}_p^{t+\Delta t}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># update particle momentum</span>
<span class="n">mv_p</span> <span class="o">=</span> <span class="n">mass_p</span> <span class="o">*</span> <span class="n">vel_p</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="update-nodal-velocity">
<h4>Update nodal velocity<a class="headerlink" href="#update-nodal-velocity" title="Permalink to this headline">#</a></h4>
<p>The typical equation to update nodal velocity is based on the nodal momentum: <span class="math notranslate nohighlight">\(\textbf{v}_i^{t + \Delta t} = (m \textbf{v})_i^{t + \Delta t} / m_i^{t}\)</span>.</p>
<p>However, we prefer to remap the particle velocity and mass and use the interpolated nodal mass to compute the nodal velocities: <span class="math notranslate nohighlight">\((\textbf{v})_i^{t + \Delta t} = \sum\limits_{p=1}^{n_P} N_i(\textbf{x}_p^{t}) m_p \textbf{v}_p^{t + \Delta t} / m_i^{t + \Delta t}\)</span></p>
<p>After updating the nodal velocity, re-constrain the velocity at the fixed node back to zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># map nodal velocity</span>
<span class="c1"># vel_n[0] = N[0] * mass_p * vel_p / mass_n[0]</span>
<span class="c1"># vel_n[1] = N[1] * mass_p * vel_p / mass_n[1]</span>
<span class="n">vel_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">mass_n</span><span class="p">)</span> <span class="o">*</span> <span class="n">mass_p</span> <span class="o">*</span> <span class="n">vel_p</span>

<span class="c1"># Apply boundary condition and set left nodal velocity to zero</span>
<span class="n">vel_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Velocity at the nodes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vel_n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Velocity at the nodes: [0.  0.1]
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-strains-and-stresses">
<h4>Compute strains and stresses<a class="headerlink" href="#compute-strains-and-stresses" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>The strain at each material point is computed by mapping the strain rate from the nodes: <span class="math notranslate nohighlight">\( \boldsymbol{\varepsilon}_p^t = \sum\limits_{p=1}^{n_P} B_i(\textbf{x}_p^t) \textbf{v}_i^t \)</span></p></li>
<li><p>The stress at each material point is updated using <span class="math notranslate nohighlight">\(\Delta\sigma_p^t\)</span> based on the constitutive model:
<span class="math notranslate nohighlight">\( \boldsymbol{\sigma}_p^t = \boldsymbol{\sigma}_p^{t-\Delta t} + \Delta \boldsymbol{\sigma}_p^t \)</span></p></li>
<li><p>The incremental stress is calculated as <span class="math notranslate nohighlight">\( \Delta\boldsymbol{\sigma}_p^t= \mathbf{D} : \Delta \boldsymbol{\varepsilon}_p^t \)</span>. In this case, we use a linear elastic model with a Young’s modulus of <span class="math notranslate nohighlight">\(E\)</span>, so the stress increment <span class="math notranslate nohighlight">\( \Delta\boldsymbol{\sigma}_p^t= E \cdot \Delta \boldsymbol{\varepsilon}_p^t \)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute strain rate at the particle</span>
<span class="c1"># strain_rate = dN[0] * vel_n[0] + dN[1] * vel_n[1]</span>
<span class="n">strain_rate_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dN</span><span class="p">,</span> <span class="n">vel_n</span><span class="p">)</span> 
<span class="c1"># compute strain increament </span>
<span class="n">dstrain_p</span> <span class="o">=</span> <span class="n">strain_rate_p</span> <span class="o">*</span> <span class="n">dt</span>
<span class="c1"># compute stress</span>
<span class="n">stress_p</span> <span class="o">+=</span> <span class="n">E</span> <span class="o">*</span> <span class="n">dstrain_p</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Strain rate: </span><span class="si">{}</span><span class="s2">, dstrain: </span><span class="si">{}</span><span class="s2"> and stress: </span><span class="si">{}</span><span class="s2"> and stress: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">strain_rate_p</span><span class="p">,</span> <span class="n">dstrain_p</span><span class="p">,</span> <span class="n">E</span> <span class="o">*</span> <span class="n">dstrain_p</span><span class="p">,</span> <span class="n">stress_p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Strain rate: 0.1, dstrain: 0.001 and stress: 0.039478417604357434 and stress: 0.039478417604357434
</pre></div>
</div>
</div>
</div>
<p>This completes all the steps in the MPM USL algorithm. These steps are repeated <code class="docutils literal notranslate"><span class="pre">n</span></code> times as shown in the full code below.</p>
</section>
</section>
</section>
<section id="d-mpm-code-complete">
<h2>1D MPM code complete<a class="headerlink" href="#d-mpm-code-complete" title="Permalink to this headline">#</a></h2>
<p>Putting it all together</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Computational grid</span>
<span class="n">L</span>          <span class="o">=</span> <span class="mi">1</span>                       <span class="c1"># domain size</span>
<span class="n">nodes</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">])</span>        <span class="c1"># nodal coordinates</span>
<span class="n">nnodes</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>              <span class="c1"># number of nodes</span>
<span class="n">nelements</span>  <span class="o">=</span> <span class="mi">1</span>                       <span class="c1"># number of elements</span>
<span class="n">nparticles</span> <span class="o">=</span> <span class="mi">1</span>                       <span class="c1"># number of particles</span>
<span class="n">el_length</span>  <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">nelements</span>           <span class="c1"># element length</span>

<span class="c1"># Initial conditions </span>
<span class="n">v0</span>         <span class="o">=</span> <span class="mf">0.1</span>                     <span class="c1"># initial velocity</span>
<span class="n">x_loc</span>      <span class="o">=</span> <span class="mf">0.5</span>                     <span class="c1"># location to get analytical solution</span>

<span class="c1"># Material property</span>
<span class="n">E</span>          <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>          <span class="c1"># Young&#39;s modulus</span>
<span class="n">rho</span>        <span class="o">=</span> <span class="mf">1.</span>                      <span class="c1"># Density</span>

<span class="c1"># Material points</span>
<span class="n">x_p</span>        <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">el_length</span>         <span class="c1"># position</span>
<span class="n">mass_p</span>     <span class="o">=</span> <span class="mf">1.</span>                      <span class="c1"># mass</span>
<span class="n">vol_p</span>      <span class="o">=</span> <span class="n">el_length</span> <span class="o">/</span> <span class="n">nparticles</span>  <span class="c1"># volume</span>
<span class="n">vel_p</span>      <span class="o">=</span> <span class="n">v0</span>                      <span class="c1"># velocity</span>
<span class="n">stress_p</span>   <span class="o">=</span> <span class="mf">0.</span>                      <span class="c1"># stress</span>
<span class="n">strain_p</span>   <span class="o">=</span> <span class="mf">0.</span>                      <span class="c1"># strain</span>
<span class="n">mv_p</span>       <span class="o">=</span> <span class="n">mass_p</span> <span class="o">*</span> <span class="n">vel_p</span>          <span class="c1"># momentum = m * v</span>

<span class="c1"># Time</span>
<span class="n">duration</span>   <span class="o">=</span> <span class="mi">10</span>
<span class="n">dt</span>         <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">time</span>       <span class="o">=</span> <span class="mi">0</span>
<span class="n">nsteps</span>     <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>

<span class="c1"># Store time, velocity and position with time</span>
<span class="n">time_t</span><span class="p">,</span> <span class="n">vel_t</span><span class="p">,</span> <span class="n">x_t</span><span class="p">,</span> <span class="n">se_t</span><span class="p">,</span> <span class="n">ke_t</span><span class="p">,</span> <span class="n">te_t</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>
    <span class="c1"># shape function and derivative</span>
    <span class="n">N</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">L</span><span class="p">])</span>
    <span class="n">dN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">L</span><span class="p">])</span>

    <span class="c1"># map particle mass and momentum to nodes</span>
    <span class="n">mass_n</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">mass_p</span>
    <span class="n">mv_n</span>   <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">mv_p</span>
    
    <span class="c1"># apply boundary condition: velocity at left node is zero</span>
    <span class="n">mv_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># external force at nodes</span>
    <span class="n">f_ext_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="c1"># compute internal force at nodes</span>
    <span class="n">f_int_n</span> <span class="o">=</span> <span class="o">-</span> <span class="n">dN</span> <span class="o">*</span> <span class="n">vol_p</span> <span class="o">*</span> <span class="n">stress_p</span> 

    <span class="c1"># total forces at nodes</span>
    <span class="n">f_total_n</span> <span class="o">=</span> <span class="n">f_int_n</span> <span class="o">+</span> <span class="n">f_ext_n</span>

    <span class="c1"># apply boundary condition: left node has no acceleration (f = m * a, and a = 0)</span>
    <span class="n">f_total_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># update nodal momentum</span>
    <span class="n">mv_n</span> <span class="o">+=</span> <span class="n">f_total_n</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c1"># update particle position and velocity</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nnodes</span><span class="p">):</span>
        <span class="n">vel_p</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">f_total_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">mass_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">x_p</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">mv_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">mass_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># update particle momentum</span>
    <span class="n">mv_p</span> <span class="o">=</span> <span class="n">mass_p</span> <span class="o">*</span> <span class="n">vel_p</span>

    <span class="c1"># map nodal velocity</span>
    <span class="n">vel_n</span> <span class="o">=</span> <span class="n">mass_p</span> <span class="o">*</span> <span class="n">vel_p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">mass_n</span><span class="p">)</span>
    <span class="c1"># Apply boundary condition and set left nodal velocity to zero</span>
    <span class="n">vel_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># compute strain rate at the particle</span>
    <span class="n">strain_rate_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dN</span><span class="p">,</span> <span class="n">vel_n</span><span class="p">)</span> 
    <span class="c1"># compute strain increament </span>
    <span class="n">dstrain_p</span> <span class="o">=</span> <span class="n">strain_rate_p</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="c1"># compute strain</span>
    <span class="n">strain_p</span> <span class="o">+=</span> <span class="n">dstrain_p</span>
    <span class="c1"># compute stress</span>
    <span class="n">stress_p</span> <span class="o">+=</span> <span class="n">E</span> <span class="o">*</span> <span class="n">dstrain_p</span>

    <span class="c1"># store properties for plotting</span>
    <span class="n">time_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">vel_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vel_p</span><span class="p">)</span>
    <span class="n">x_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span>

    <span class="c1"># Energies</span>
    <span class="n">strain_energy</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">stress_p</span> <span class="o">*</span> <span class="n">strain_p</span> <span class="o">*</span> <span class="n">vol_p</span>
    <span class="n">kinetic_energy</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">vel_p</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mass_p</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">total_energy</span> <span class="o">=</span> <span class="n">strain_energy</span> <span class="o">+</span> <span class="n">kinetic_energy</span>
    <span class="n">se_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">strain_energy</span><span class="p">)</span>
    <span class="n">ke_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kinetic_energy</span><span class="p">)</span>
    <span class="n">te_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_energy</span><span class="p">)</span>
    
    <span class="c1"># update time</span>
    <span class="n">time</span> <span class="o">+=</span> <span class="n">dt</span>
</pre></div>
</div>
</div>
</div>
<section id="plot-results-of-mpm-and-analytical-solution">
<h3>Plot results of MPM and analytical solution<a class="headerlink" href="#plot-results-of-mpm-and-analytical-solution" title="Permalink to this headline">#</a></h3>
<p>Compare the MPM results with the analytical solution.</p>
<blockquote>
<div><p>Velocity</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">ta</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="n">xa</span> <span class="o">=</span> <span class="n">analytical_vibration</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">x_loc</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_t</span><span class="p">,</span> <span class="n">vel_t</span><span class="p">,</span> <span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mpm&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;velocity (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/point-axial-vibration1d_54_0.png" src="_images/point-axial-vibration1d_54_0.png" />
</div>
</div>
<blockquote>
<div><p>displacement</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_t</span><span class="p">,</span> <span class="n">x_t</span><span class="p">,</span> <span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mpm&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;displacement (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/point-axial-vibration1d_56_0.png" src="_images/point-axial-vibration1d_56_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_t</span><span class="p">,</span> <span class="n">se_t</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;strain energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_t</span><span class="p">,</span> <span class="n">ke_t</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;kinetic energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_t</span><span class="p">,</span> <span class="n">te_t</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;total energy&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/point-axial-vibration1d_57_0.png" src="_images/point-axial-vibration1d_57_0.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Welcome to learn MPM with Python</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="axial-vibration1d.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Axial vibration of a 1D bar</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Krishna Kumar<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>