

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>An introduction to the Material Point Method &#8212; Learn MPM</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'mpm';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MPM stress update schemes" href="mpm-schemes.html" />
    <link rel="prev" title="Welcome to learn MPM with Python" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to learn MPM with Python
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">An introduction to the Material Point Method</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="mpm-schemes.html">MPM stress update schemes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="usf.html">Update Stress First (USF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="usl.html">Update Stress Last (USL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="update.html">Update</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="point-axial-vibration1d.html">1D vibration of a single material point</a></li>
<li class="toctree-l1"><a class="reference internal" href="axial-vibration1d.html">Axial vibration of a 1D bar</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mpm-code.html">Coding 1D MPM</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="learnmpm-axial-vibration1d.html">Axial vibration of 1D bar using LearnMPM</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/geoelements/learn-mpm" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/geoelements/learn-mpm/issues/new?title=Issue%20on%20page%20%2Fmpm.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/mpm.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>An introduction to the Material Point Method</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motion-of-deformable-body">Motion of deformable body</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#governing-equations">Governing equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#weak-form-and-spatial-discretisation">Weak form and spatial discretisation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-integration-and-numerical-implementation">Time integration and numerical implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conservation-properties">Conservation properties</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="an-introduction-to-the-material-point-method">
<h1>An introduction to the Material Point Method<a class="headerlink" href="#an-introduction-to-the-material-point-method" title="Permalink to this heading">#</a></h1>
<p>In continuum mechanics, there are two main descriptions of material motion: Lagrangian and Eulerian.
The Lagrangian (material) description uses the initial configuration (i.e. at time, <span class="math notranslate nohighlight">\(t = 0\)</span>) to describe the physical quantities and the deformation state of a continuum body. So, the emphasis is given to individual particles in Lagrangian kinematic description.
On the other hand, the Eulerian (or spatial) approach describes the motion of a continuum body with respect to the current coordinates and time.
The spatial description therefore focuses on a specific position in space at current time.</p>
<p>The Material Point Method (MPM) is a hybrid Eulerian-Lagrangian approach, which uses moving material points on  a fixed computational background grid.
The MPM is a particle based method that represents the material as a collection of material points, and their deformations are determined by Newton’s laws of motion.
This approach is very effective particularly in the context of large deformations.</p>
<p><img alt="algorithm" src="_images/mpm-algorithm.png" /></p>
<blockquote>
<div><p>Illustration of the MPM algorithm: (1) A representation of material points overlaid on a computational grid.
Arrows represent material point state vectors (mass, volume, velocity, etc.) being projected to the nodes of the computational grid.
(2) The equations of motion are solved onto the nodes, resulting in updated nodal velocities and positions.
(3) The updated nodal kinematics are interpolated back to the material points.
(4) The state of the material points is updated, and the
computational grid is reset</p>
</div></blockquote>
<section id="motion-of-deformable-body">
<h2>Motion of deformable body<a class="headerlink" href="#motion-of-deformable-body" title="Permalink to this heading">#</a></h2>
<p>It is essential to consider a proper description of motion in finite deformation analysis. In fact, material point method describes the behaviour of a deformable body in an updated Lagrangian frame.</p>
<p><img alt="motion of deformable body" src="_images/motion-of-a-deformable-body.png" /></p>
<blockquote>
<div><p>Motion of a deformable body in continuum mechanics</p>
</div></blockquote>
<p>The figure shows the general motion of a continuum body. The material particles are labelled with the position <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> at their initial configuration (time <span class="math notranslate nohighlight">\(t = 0\)</span>). At current configuration at time <span class="math notranslate nohighlight">\(t = t\)</span>, these particles are located at positions <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. Motion between the initial and the current positions is mathematically described by a mapping function, <span class="math notranslate nohighlight">\(\phi\)</span> as</p>
<div class="math notranslate nohighlight">
\[\mathbf{x} = \phi (\mathbf{X},t)\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\mathbf{X} = \phi (\mathbf{X},0)\]</div>
<p>Despite the fact that the equations are solved in  Lagrangian framework, the spatial quantities in MPM are expressed in terms of the spatial position, \textbf{x}. Hence, the displacement, <span class="math notranslate nohighlight">\(\mathbf{u}(\mathbf{x},t)\)</span>, velocity, <span class="math notranslate nohighlight">\(\mathbf{v}(\mathbf{x},t)\)</span> and the acceleration, <span class="math notranslate nohighlight">\(\mathbf{a}(\mathbf{x},t)\)</span> can be defined as</p>
<div class="math notranslate nohighlight">
\[
\mathbf{u}(\mathbf{x},t) = \mathbf{x} - \mathbf{X}
\]</div>
<div class="math notranslate nohighlight">
\[
\mathbf{v}(\mathbf{x},t) = \dfrac{d \mathbf{u}}{dt} (\mathbf{x},t)
\]</div>
<div class="math notranslate nohighlight">
\[
\mathbf{a}(\mathbf{x},t) = \dfrac{d \mathbf{v}}{dt} (\mathbf{x},t)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\dfrac{d}{dt} = \dfrac{\partial}{\partial t} + \mathbf{v} \cdot \nabla\)</span> is the material time derivative.</p>
<p>In large deformation analysis with inelastic material behaviour, it is usually difficult to follow the deformation history. Hence, the material motion is usually described in terms of small increments of the deformation and the stress-strain relationships are defined in incremental form. The symmetric small strain tensor, <span class="math notranslate nohighlight">\(\pmb{\epsilon}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\epsilon = \dfrac{1}{2} \big( \nabla \mathbf{u} + (\nabla \mathbf{u})^T \big)\]</div>
<p>with its rectangular Cartesian components</p>
<div class="math notranslate nohighlight">
\[
\pmb{\epsilon}_{ij} = \dfrac{1}{2} \bigg( \dfrac{\partial \mathbf{u}_i}{\partial \mathbf{x}_j} + \dfrac{\partial \mathbf{u}_j}{\partial \mathbf{x}_i} \bigg)
\]</div>
<p>In the viscous behaviour of materials or in most plasticity theories, the equations are generally formulated in terms of the rate of deformation. The rate of deformation tensor is defined as</p>
<div class="math notranslate nohighlight">
\[
\mathbf{D} = \dfrac{1}{2} \big(L + L^T \big)
\]</div>
<p>where <span class="math notranslate nohighlight">\(L = \nabla \mathbf{v}\)</span> is the velocity gradient.</p>
<p>The rectangular Cartesian components of the rate of deformation tensor are given by</p>
<div class="math notranslate nohighlight">
\[
\mathbf{D}_{ij} = \dfrac{1}{2} \bigg( \dfrac{\partial \mathbf{v}_i}{\partial \mathbf{x}_j} + \dfrac{\partial \mathbf{v}_j}{\partial \mathbf{x}_i} \bigg)
\]</div>
</section>
<section id="governing-equations">
<h2>Governing equations<a class="headerlink" href="#governing-equations" title="Permalink to this heading">#</a></h2>
<p>Material motion is mathematically represented by the conservation laws expressed in differential form. For the problems considered in this study, the governing equations include only the conservation of mass and momentum.</p>
<p>The conservation of mass which is also referred to as the continuity equation (\ref{mass-conservation}) states that mass of a closed system (i.e. closed to all transfers of matter and energy) must remain constant.</p>
<div class="math notranslate nohighlight">
\[
\dfrac{d \rho}{dt} + \rho \nabla \cdot \mathbf{v} = 0
\]</div>
<p>The linear momentum balance equation is also called as the equation of motion and it is derived by applying the Newton’s second law to a continuum body.</p>
<div class="math notranslate nohighlight">
\[
\rho \dfrac{d \mathbf{v}}{dt} = \nabla \cdot \pmb{\sigma} + \rho \mathbf{b}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho(\mathbf{x},t)\)</span> is the mass density, <span class="math notranslate nohighlight">\(\pmb{\sigma}(\mathbf{x},t)\)</span> is the symmetric Cauchy stress tensor and <span class="math notranslate nohighlight">\(\mathbf{b}(\mathbf{x},t)\)</span> is the external body force.</p>
</section>
<section id="weak-form-and-spatial-discretisation">
<h2>Weak form and spatial discretisation<a class="headerlink" href="#weak-form-and-spatial-discretisation" title="Permalink to this heading">#</a></h2>
<p>MPM describes the whole material domain, <span class="math notranslate nohighlight">\(\Omega\)</span> with a set of Lagrangian material points that are tracked throughout the deformation process.
An Eulerian grid is used to solve the equation of motion.
The grey circles are the material points <span class="math notranslate nohighlight">\(x_{p}\)</span>, where <em>p</em> represents a material point, and the computational nodes are the points of intersection of the grid (denoted as <span class="math notranslate nohighlight">\(X_{i}\)</span>, where <em>i</em> represents a computational node).
The MPM involves discretising the domain, <span class="math notranslate nohighlight">\(\Omega\)</span>, with a set of material points.
The material points are assigned an initial value of position, velocity, mass, volume, and stress, denoted as
<span class="math notranslate nohighlight">\(\mathbf{x}_{p}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{\mathit{v}}_{p}\)</span>, <span class="math notranslate nohighlight">\(\mathit{m}_{p}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{V}_{p}\)</span>, and <span class="math notranslate nohighlight">\(\sigma_{p}\)</span>.
Depending on the material being simulated, additional parameters, like pressure, temperature, pore-water pressure, etc., are specified at the material points.
The material points are assumed to be within the computational grid which for ease of computation, is assumed to be a Cartesian lattice.
At every time step <span class="math notranslate nohighlight">\(\mathit{t}_{k}\)</span>, the MPM computation cycle involves projecting the data, such as position, mass, and velocity, from the material points to the computational grid using the standard nodal basis functions, called the <em>shape functions</em>, derived from the position of the particle with respect to the grid.
Gradient terms are calculated on the computational grid, and the governing equation, i.e. the equation of motion, is solved with the updated position and velocity values mapping back to the material points.
The mesh is reinitialised to its original state and the computational cycle is repeated.</p>
<p>The material domain is discretized in to a <span class="math notranslate nohighlight">\(n_p\)</span> number of points in its initial configuration, <span class="math notranslate nohighlight">\(\Omega^0\)</span> with its material coordinates <span class="math notranslate nohighlight">\(\mathbf{x}_p^0\)</span> at time <span class="math notranslate nohighlight">\(t=0\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}_p^t\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> <span class="math notranslate nohighlight">\((p = 1, 2, ..., n_p)\)</span>. Each material point represents an infinitesimal mass element with a fixed mass <span class="math notranslate nohighlight">\(M_p\)</span> through out the computation. Hence, mass density can be expressed as</p>
<div class="math notranslate nohighlight">
\[
\rho(\mathbf{x},t) = \sum_{p=1}^{n_p} M_p \delta (\mathbf{x} - \mathbf{x}_p^t)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta\)</span> is the Dirac delta function.</p>
<p><img alt="MPM discretization" src="_images/mpm-discretization.png" /></p>
<p>The background mesh consists of a total number of nodes, <span class="math notranslate nohighlight">\(n_n\)</span> that are located at <span class="math notranslate nohighlight">\(\mathbf{x}_i\)</span> with shape functions <span class="math notranslate nohighlight">\(N_i(\mathbf{x})\)</span> (<span class="math notranslate nohighlight">\(i = 1,2,...,n_n\)</span>). The position, displacement, velocity and acceleration at any point in the continuum body are approximated using the shape functions similar to the finite element method.</p>
<p>The coordinates of a point at any given time is approximated using the nodal basis functions as</p>
<div class="math notranslate nohighlight">
\[
\mathbf{x} = \sum_{i=1}^{n_n} \mathbf{x}_i N_i(\mathbf{x})
\]</div>
<p>Similarly, the displacement, velocity and acceleration fields of a point in the material domain at any given time <span class="math notranslate nohighlight">\(t\)</span> can be approximated by</p>
<div class="math notranslate nohighlight">
\[
\mathbf{u} (\mathbf{x},t) = \sum_{i=1}^{n_n} \mathbf{u}_i(t) N_i(\mathbf{x})
\]</div>
<div class="math notranslate nohighlight">
\[
\mathbf{v} (\mathbf{x},t) = \sum_{i=1}^{n_n} \mathbf{v}_i(t) N_i(\mathbf{x})
\]</div>
<div class="math notranslate nohighlight">
\[
\mathbf{a} (\mathbf{x},t) = \sum_{i=1}^{n_n} \mathbf{a}_i(t) N_i(\mathbf{x})
\]</div>
<p>The fixed mass, <span class="math notranslate nohighlight">\(m_p\)</span> at the material points in equation implies that the equation of conservation of mass is automatically satisfied.</p>
<p>Following the finite element method, the weak form of the linear momentum balance equation is obtained by multiplying the momentum conservation equation by a test function, <span class="math notranslate nohighlight">\(\delta \mathbf{v}\)</span>  and integrating over the current configuration, <span class="math notranslate nohighlight">\(\Omega\)</span> as</p>
<div class="math notranslate nohighlight">
\[
\int_{\Omega} \delta \mathbf{v} \cdot \rho \mathbf{a} \hspace{3pt} d\Omega = \int_{\Omega} \delta \mathbf{v} \nabla \cdot \pmb{\sigma} \hspace{3pt} d\Omega + \int_{\Omega} \delta \mathbf{v}  \cdot \rho \mathbf{b} \hspace{3pt} d\Omega
\]</div>
<p>where <span class="math notranslate nohighlight">\(d\Omega\)</span> is the differential volume.</p>
<p>The test function, <span class="math notranslate nohighlight">\(\delta \mathbf{v}\)</span> is also expressed using the nodal basis functions as in equation.</p>
<div class="math notranslate nohighlight">
\[
\delta \mathbf{v} (\mathbf{x},t) = \sum_{i=1}^{n_n} \delta \mathbf{v}_i(t) N_i(\mathbf{x})
\]</div>
<p>Applying integration by parts and the divergence theorem to the term involving the stress, weak form equation can be rewritten as</p>
<div class="math notranslate nohighlight">
\[
\int_{\Omega} \rho \delta \mathbf{v} \cdot \mathbf{a} \hspace{3pt} d\Omega = -\int_{\Omega} \nabla \delta \mathbf{v} : \pmb{\sigma} \hspace{3pt} d\Omega + \int_{\partial \Omega_\Gamma} \delta \mathbf{v} \hspace{3pt} \cdot \mathbf{t} \hspace{3pt} dS + \int_{\Omega}  \rho \delta \mathbf{v}  \cdot \mathbf{b} \hspace{3pt} d\Omega
\]</div>
<p>where <span class="math notranslate nohighlight">\(dS\)</span> is the differential surface, <span class="math notranslate nohighlight">\(\mathbf{t} = \pmb{\sigma} \cdot \mathbf{n}\)</span> is the prescribed surface traction and <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> is the unit normal vector to the boundary.</p>
<p>Substituting acceleration equations and test function in the weak form equation gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\sum_{i,j=1}^{n_n} \int_{\Omega} \rho N_i(\mathbf{x}) N_j(\mathbf{x}) \mathbf{a}_j(t) \hspace{3pt} d\Omega = &amp; -\sum_{i=1}^{n_n} \int_{\Omega} \nabla N_i(\mathbf{x}) : \pmb{\sigma} (\mathbf{x},t) \hspace{3pt} d\Omega \\
&amp; + \sum_{i=1}^{n_n} \int_{\partial \Omega_\Gamma} N_i(\mathbf{x}) \mathbf{t}(\mathbf{x},t) \hspace{3pt}dS \\
&amp; + \sum_{i=1}^{n_n} \int_{\Omega} \rho N_i(\mathbf{x}) \mathbf{b}(\mathbf{x},t) \hspace{3pt} d\Omega
\end{aligned}
\end{split}\]</div>
<p>In contrary to the Gauss integration in FEM, MPM considers the locations of material particles as the integration points. This converts the integrals in weak form equation into sums over the material particles. As a result, the semi discrete momentum equation can be written in the form of</p>
<div class="math notranslate nohighlight">
\[
\sum_{j=1}^{n_n} M_{ij} \mathbf{a}_j = \mathbf{F}_i^{int} + \mathbf{F}_i^{ext}
\]</div>
<p>where <span class="math notranslate nohighlight">\(M_{ij}\)</span> is the consistent mass matrix, <span class="math notranslate nohighlight">\(\mathbf{F}_i^{int}\)</span> is the internal force vector and <span class="math notranslate nohighlight">\(\mathbf{F}_i^{ext}\)</span> is the external force vector.</p>
<p>The consistent mass matrix is given by
$<span class="math notranslate nohighlight">\(
M_{ij} = \sum_{p=1}^{n_p} N_i(\mathbf{x}_p) N_j(\mathbf{x}_p) M_p
\)</span>$</p>
<p>The internal force vector computed at the grid nodes is written as
$<span class="math notranslate nohighlight">\(
\mathbf{F}_i^{int} = - \sum_{p=1}^{n_p} \nabla N_i(\mathbf{x}_p) : \pmb{\sigma}(\mathbf{x}_p,t) V_p
\)</span>$</p>
<p>and the external force vector is
$<span class="math notranslate nohighlight">\(
\mathbf{F}_i^{ext} = \int_{\partial \Omega_\Gamma} N_i(\mathbf{x}) \mathbf{t} (\mathbf{x},t) \hspace{3pt} dS + \sum_{p=1}^{n_p} N_i(\mathbf{x}_p) \mathbf{b}(\mathbf{x}_p,t)M_p
\)</span>$</p>
<p>In the standard MPM formulation, the consistent mass matrix is generally replaced by the lumped masses at nodes, <span class="math notranslate nohighlight">\(m_i\)</span>. This practice leads to a straightforward computation of the nodal acceleration in semi-discrete formulation.</p>
</section>
<section id="time-integration-and-numerical-implementation">
<h2>Time integration and numerical implementation<a class="headerlink" href="#time-integration-and-numerical-implementation" title="Permalink to this heading">#</a></h2>
<p>In order to obtain the fully discrete form of the governing equations, semi-discrete equation must be discretized in time. MPM is well known for its explicit dynamic formulation which employs the forward Euler (explicit) time integration scheme. This follows that nodal acceleration in semi-discrete equation is solved explicitly using the known internal and external forces at the current configuration at time <span class="math notranslate nohighlight">\(t\)</span> as</p>
<div class="math notranslate nohighlight">
\[
m_i^t \mathbf{a}_i^t = \mathbf{F}_i^{t,int} +\mathbf{F}_i^{t,ext}
\]</div>
<p>\noindent where <span class="math notranslate nohighlight">\(m_i^t\)</span> is lumped mass at the nodes.</p>
<p>The implicit velocity, <span class="math notranslate nohighlight">\(\mathbf{v}_i^{t+\triangle t}\)</span> is computed as</p>
<div class="math notranslate nohighlight">
\[
\mathbf{v}_i^{t+\triangle t} = \mathbf{v}_i^t + \triangle t \hspace{3pt} \mathbf{a}_i^t
\]</div>
<p>\noindent where <span class="math notranslate nohighlight">\(\triangle t\)</span> is the time increment.</p>
<p>The explicit time integration is computationally convenient. However, it is a conditionally stable scheme which restricts the time step size to ensure numerical stability. Consequently, the time step must satisfy the Courant–Friedrichs–Lewy (CFL) condition. This is a necessary condition for convergence in explicit time marching numerical methods.</p>
<p>For one dimensional case, the CFL condition has the following form,</p>
<div class="math notranslate nohighlight">
\[
C = \dfrac{u \Delta t}{\Delta x} \leq C_{max}
\]</div>
<p>\noindent where <span class="math notranslate nohighlight">\(u\)</span> is the characteristic wave speed,  <span class="math notranslate nohighlight">\(\Delta x\)</span> is the spacing of the grid, <span class="math notranslate nohighlight">\(\Delta t\)</span> is the time step size and <span class="math notranslate nohighlight">\(C_{max}\)</span> is the maximum Courant number which is unity for most explicit methods.</p>
<p>In order to solve the fully discrete form and velocity update equation at the grid nodes,  mass and velocity carried by the material points must be transferred to the background grid. At the beginning of each Lagrangian time step,  particle mass is mapped to the nodes using</p>
<div class="math notranslate nohighlight">
\[
m_i^t = \sum_{p=1}^{n_p} N_i(\mathbf{x}_p^t) M_p
\]</div>
<p>Nodal velocity at each time step is computed by mapping particle momentum as</p>
<div class="math notranslate nohighlight">
\[
\mathbf{v}_i^t = \dfrac{\sum_{p=1}^{n_p}M_p \mathbf{v}_p^t N_i(\mathbf{x}_p^t)}{m_i^t}
\]</div>
<p>With acceleration, <span class="math notranslate nohighlight">\(\mathbf{a}_i^t\)</span> solved at the nodes using fully discrete form equation, the material points are updated while the grid is assumed to move with the computed velocity field. Moving of material points through the grid completes the Lagrangian description used in the MPM formulation.</p>
<p>Finally, the velocity and the position of material points are updated by</p>
<div class="math notranslate nohighlight">
\[
\mathbf{v}_p^{t + \triangle t} = \mathbf{v}_p^t + \triangle t \hspace{3pt} \sum_{i=1}^{n_n}N_i(\mathbf{x}_p^t) \mathbf{a}_i^t
\]</div>
<div class="math notranslate nohighlight">
\[
\mathbf{x}_p^{t + \triangle t} = \mathbf{x}_p^t + \triangle t \hspace{3pt} \sum_{i=1}^{n_n}N_i(\mathbf{x}_p^t) \mathbf{v}_i^{t + \triangle t}
\]</div>
<p>It should be noted from internal force equation that stress and strain are carried by the material points. This implies that the constitutive equations are applied at the material points. As a result, following the history of deformation is convenient in MPM. Similarly, the external body forces are also applied at the material points as in the external force equation.</p>
</section>
<section id="conservation-properties">
<h2>Conservation properties<a class="headerlink" href="#conservation-properties" title="Permalink to this heading">#</a></h2>
<p>MPM automatically satisfies the mass conservation by assigning a constant mass to each material point.
The momentum balance is enforced in governing equations.
However, Bardenhagen (2002) showed that the original MPM formulation does not satisfy the energy conservation explicitly.
It was found that the energy conservation in MPM is strongly
dependent on the two algorithms which are used to update the stress at material points.</p>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to learn MPM with Python</p>
      </div>
    </a>
    <a class="right-next"
       href="mpm-schemes.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">MPM stress update schemes</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motion-of-deformable-body">Motion of deformable body</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#governing-equations">Governing equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#weak-form-and-spatial-discretisation">Weak form and spatial discretisation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-integration-and-numerical-implementation">Time integration and numerical implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conservation-properties">Conservation properties</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Krishna Kumar, Shyamini Kularathna
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>