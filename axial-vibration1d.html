
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Axial vibration of a 1D bar &#8212; Learn MPM</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Coding 1D MPM" href="mpm-code.html" />
    <link rel="prev" title="1D vibration of a single material point" href="point-axial-vibration1d.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Learn MPM</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to learn MPM with Python
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="point-axial-vibration1d.html">
   1D vibration of a single material point
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Axial vibration of a 1D bar
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="mpm-code.html">
   Coding 1D MPM
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="learnmpm-axial-vibration1d.html">
     Axial vibration of 1D bar using LearnMPM
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/geoelements/learn-mpm/main?urlpath=lab/tree/docs/axial-vibration1d.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/geoelements/learn-mpm/blob/main/docs/axial-vibration1d.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/geoelements/learn-mpm"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/geoelements/learn-mpm/issues/new?title=Issue%20on%20page%20%2Faxial-vibration1d.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/axial-vibration1d.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mpm-axial-vibration-of-a-1d-bar">
   MPM axial vibration of a 1D bar
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-results">
     Plot results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extending-it-to-support-multiple-material-points">
   Extending it to support multiple material points
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-material-points-in-a-cell">
     Generating material points in a cell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-multiple-material-points-per-cell">
     Generating multiple material points per cell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iterate-over-particles">
     Iterate over particles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiple-material-points-per-cell">
     Multiple material points per cell
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Axial vibration of a 1D bar</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mpm-axial-vibration-of-a-1d-bar">
   MPM axial vibration of a 1D bar
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-results">
     Plot results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extending-it-to-support-multiple-material-points">
   Extending it to support multiple material points
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-material-points-in-a-cell">
     Generating material points in a cell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-multiple-material-points-per-cell">
     Generating multiple material points per cell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iterate-over-particles">
     Iterate over particles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiple-material-points-per-cell">
     Multiple material points per cell
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="axial-vibration-of-a-1d-bar">
<h1>Axial vibration of a 1D bar<a class="headerlink" href="#axial-vibration-of-a-1d-bar" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/geoelements/learn-mpm/blob/main/book/axial-vibration1d.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<a class="reference external" href="https://jupyter.designsafe-ci.org/user/name/notebooks/CommunityData/Use%20Case%20Products/MPM/LearnMPM/axial-vibration1d.ipynb"><img alt="Try on DesignSafe" src="https://img.shields.io/badge/Open%20in-DesignSafe-blue.svg?logo=data:image/png%3Bbase64,iVBORw0KGgoAAAANSUhEUgAAAFUAAAAeCAYAAABdalL1AAABhWlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw1AUhU/TiiIVQTuIOESoThZERRy1CkWoEGqFVh1MXvoHTRqSFBdHwbXg4M9i1cHFWVcHV0EQ/AFxdXFSdJES70sKLWK88Hgf591zeO8+QKiXmWaFxgFNt81UIi5msqti5ysCCKIPwwjJzDLmJCkJ3/q6p26quxjP8u/7s3rUnMWAgEg8ywzTJt4gnt60Dc77xBFWlFXic+Ixky5I/Mh1xeM3zgWXBZ4ZMdOpeeIIsVhoY6WNWdHUiKeIo6qmU76Q8VjlvMVZK1dZ8578heGcvrLMdVpDSGARS5AgQkEVJZRhI0a7ToqFFJ3HffyDrl8il0KuEhg5FlCBBtn1g//B79la+ckJLykcBzpeHOdjBOjcBRo1x/k+dpzGCRB8Bq70lr9SB2Y+Sa+1tOgR0LsNXFy3NGUPuNwBBp4M2ZRdKUhLyOeB9zP6pizQfwt0r3lza57j9AFI06ySN8DBITBaoOx1n3d3tc/t357m/H4ABSdyex4eUGsAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAALiMAAC4jAXilP3YAAAAHdElNRQfnAQMSJgg653vMAAAAGXRFWHRDb21tZW50AENyZWF0ZWQgd2l0aCBHSU1QV4EOFwAAGRZJREFUaN7FmnmMXVed57+/c+69b9+rXm2u1XZ5rTh2nMQxZIcECEkIzdLp6YEW3Wim6WE0LUF3a/5AjTQSEkKiNc0MgtEAmjQEhiXB2UicPSGbE2xnKccu176/evt213N+88erchwIO9KcUulW6d5z372f8zu/5ft79JMXZv7x7Aq2B0IC0ADj14y3ThBd+AvMnSOgN4/vNI/wm4YgDQaQCqnS3qH4j64ZiZwEwGYswwDw4KlXuqQhu03LWrphfG/j4rnTjz1yu1hfuUG2mxGGAAQBpqVZSJ8ADdaCAmVCK8HM2Hzgiz5cMEzTZyE0AKa33pQIEFDKgO+Li+exITWk6ZMgBlgg8EzhB+TLkIpP7DlmeDAqT09XPnqiZaYVFAwwmAFNBGIAECBihEhxUpLqMskzBZpM5Pia2fa1KYWZK3qB2WKIgEUHMQEEhmCG/g1QmRiaGP2CgptH8fhlE/nvmLG0BoCVWpGenllMvFoq3gFDfCQVi3zt2LkzD982vse7wKTRXG2//sZRsTxziBUEEnEd2r1nQXZve0QFalE1ml16fvYmXl/aoXQg3mY1phXIXO+SMTj8GNLZeQippAaYAmIpYiLg3f7y6tFgbqqH2zUABCFDzAODJ83h7U+ZsYTSduuAP3f+sL+2mNKp3teUZf6LUW3yDw8MRK4uLXgfO+eS1YHC0AC0YAho5CWCbSFZ7I/JM8M541w8bk2ZYavgtpxgdXUtJaKpdxfrxuXnq3pw2eewxyACQ4HgU+d+v9ZKQYgxYU/WWD20I/nNnp7Uua1zr6yXzHWndbCogzubtnftAOmlhLTOvbS+ev6Knj4FAAP7955cqhT+r9eo7uBqMS1aLQpm56QmuWSMDH4rEu22XKcdc8vrQ3D9sNy0OA7FXMr1vGntGr87umPs+6FsZjEzcYVee/YRClYLSdVqXeMVCxPB6kJUtFtgMDQEKJ2rG30DPwj1dP04WF252l9evkIV1sIykqyEB7Z9O5TKLhg9uWhdMd010QoOlNaCfeVACoAgWcMEI2+SP5GR5/oS8oeDGfNne0cS50eHkg1iMyAirtq9YmWjcWxlzb4pu2h/5FQheNe0S2lb602Yv3nrA8BYmNwrxyI/GuqN/2y72dkfL5U2xMzKypCjgg8FrMZDEMsG0wEIfLBht/4NwDoAWDt2+8XHH76rVqocdVrNW7XfllQr9+pC/DqRSj5OiVSVBEWJOluPQUAoZqNn4DVrdOyu8PDovXL37rVMz7B2zvyCyrPzXfbS0nv0+vrfcHH9SnLbMb3p2gQIkLLFJNbbi0vbeH7uTqqsXwkIRjz7EAnjASMWd4w7Dnarf/v50smBtPGjnXW/91RDddsQECD0SHiX5ui1fQPWN3pS1rH+XLQYQIUfe2Ut32yoNEFRNBaqjuXCxYntyR8FWs+3Pb/tV/iWsy5Ff4OBYssTZwXrA73ypUvGkt+8diTV2jpXbTQyjgpuEYwrRxPJ4yboSQg6ULFbV3m+d+rhN89Ubt7dcQPp7TsKzVLxq6JY2MOrc7uYmUWr7cJxk25t6XJvaeFK7TkmgUCxpC96t50yh4b/V3zX+MPxoW1rkZ5h3Vo8LxeffKxXuv4ngqWVO7la2A3PNTt2QSAmAAq6Xsygmj1qZHMR1233gNmgbPcZSmd+rM3QUt/1N7ABAFbErMQixv29Mbm/21YfXAg4kpKkd6XE9M5u+bXBbvOege50a2qu1F+qB0eLLRxtu3ocUDJaD2ZKpdaTRw/knh9M0yvFlPhh1eEdGz5fuqFBdLHrf1vYIoRI82VZWh/NW/8y3J+c2rrmwekz1nqtvKfWbt9gShGMZ7sfz0WjT7ywMD+23G5MZKzwrVEzMvf82ursVb192hjerpcff+j5oL//m16t8gXtOiERiQdMxn6/sHSbrpWHwIEQLCCSGdvs63smOjL4RHJkZC00MKoLHAjv7GSfWi18xltd+pSoVPOkXGIQBG+Fr82D04pwuXg9ZXMk40mLyaiKXM/Dob6+X4QyWRcADAD42KGe4Mv3TZ9NhOUPB6LY1WryRLfB1YGk+eDekcyDCILGG1OVofmi+4nZoveRhTaN1rQIA4wI1Lt3JOh9oXD9rvH+2L/2dtGpqudMFlx/X9GGRdC/5EM7vwSNYYudQwOh4zvNFTn1xOTN9/30GACgOXk+2rRwvRBye8IMr28sLBxd12p7yW7fVPbsEUjzfbmmXVpdWHz1p/cd8wUIr7Q85EZ2r3a37eeChZnrRSqxTdvN27i0cYBc1yQWYAKCStnSi0uXIBI5opWuVX7xXNUHwH4QF25wQNfreSiHGAxAbPG8aG8B3KgMc6t+k5FOx3QscVJms/cZqfRa36238gWoAPDeA13tV2fqL4Wk85RW/kjU5Pl8XDz8scvyhe88u5JYrXq3Txb8T062eKSuIDRp+ESIaMPYqKmh9nn1l0D9/PhQ/HihgYVEkdomwwpI4+1PRtAgpKTGeFq8mKL6A3NTr/9X37YzxB1L9sCiqb2kYRhGMdD9bc87aphSN5S2lOsbDcL2pVD4v1RMsyVJaAGAwVhNZuduGBn7rmw39sKxJ1CvQLSqhgbAECBWgFMLc0Hf6JlGt1cqU82y7t996GiDJ1871xod+ZKfio/bp09tJ69J8h0yFwKBvbYVrMwPy/y2BTPfc8zqyp0euP32CxnJBagHh1L89Kur62sVce9IGtsNQzb6uyIzAFBpeDvnSt4t820MNZUQAoBgwGACQcHVRMuO7pkr+DcNdUdOVNtqpRlwk4D0Ly01GECYgB1RWswnjO+iuTAzNzebaJQrMSIiDpkhNowYK6YOLMR4izYJWKBAe25zjSCFaea1H7jwA18TOJ/vM2uHJ55PxlLfCxYXP0Otcoq0AtNmDr7lhuymqebPT1A89VlKdxnzd33nkVqjWsxcvu/59uzK591i+e/08tzV7NmhX4kLzIAClN1qaqUek+HI8Xj/YP3iS4yL/7nmkj7naw9OnRrMygdchUs1B5lCqy6/+Uhhb9nVo4WADX9z5QQAgzUUERgSjnLNhiO7PE93OQ5HHc1SAZCbCZpGB5EgYGeEnZ1Z8Vg+KZ82S/WSYPXPILLC2Uwsun3kvXUpP9BUgeQLVtJxISZJzoXCy6JU+QF7XhDt6b7OabZeK547fypwXM+CromurkWxuvpTTsYv5XbtPQLSxGa+3En0qGNvnmNxXV3G0vy8du3x9sbGN2Q7uqyF8aA5POi5Xpt0qXCdsG3Jb8urCWRYWuZ6p2V37kGZjC2krjyify1UABjrT9Rm1hrPNl012mx7N5yebc3W2jplK4r4m8vGm6+pCAgIsJhhCqh4hOxI1MqHLedyzZxWRJBMIGjIzY2UBIKBGL0xlDMfGsxHl7msbQn8eGj/PmPo6JErp+uVP282m8Jl3alptiydAIOEDkdj9Z379k9J5tXZWnVXXJDfs3vXE5MPP7oUNqSOpVOeiEXOykzmmLZb4yhtjJEOiGkTJvMFi6XAt7ha3NeeOW+1Sxv3IRpd3vfZz3nz93zvhO7KPsN262q2Hfm2apIBisXLMpO938rmXkyNDdu/zPBXoH7g0l7105Mrs0uF9omGHbzv9fnmYTMstBDQ9A6Zp8WAyeCcaZWH0vK15aK3f62JK4oBhxmdvPCtaE8Yi6HUExcPJEL0fDJK9q1/9dcagH1s+lxqqVL6yLrnXeoIQRrU+SAmmACyptnsi0SnsuHwUoODo55WZpHVBPu4rKur+9RNn/7ru24f3+394xe/iIV7vt9QrvO0rlcv5Ub148IJ0gwGE2+mRltBhyE8V6haNcmsLREEVHjiAdjLq0l2/F267chfqQDNkBK5rhdkJnO/lUqupSau4N8KFQCGehPNRst7tuEE43XXvyWbiE7FTNRjxGjyW/WRIsAAYyId8Af3ZjaqDTv/7Pn2kfN16qtqkIDuFNAs4BOh24Q3lqbTg13W8a5MeP3WS/o1ACyzplemz98yUy7fXg+C6JZ7CTGQNQ07H42fyYYjbzIht95sbK947hHNCDd0ECElRLRR+xvBfBzAAgAM3fHnavo735zjcPReHUnsId+/CjrYLCsu3soduCIUhkykYGUycNYKMqhUDupS6Xq2bUkXaRpMBE5lFqi7957Y8Mgb+Rtv8d+J3ztCPdiX4JfmK+u2No6vFuufQ+B5u7vC8xu2t/2srcOABhMhpDuA43GLXl9uj0xuuP0rLqXbGobBgIYBBhATwGhUc9b05+KG8d24JV6984ptF6Llcmmj/82Ntc8XHK8HAGIGqR4rUslHYqfz0diCE3jZ5UbzwLrrDjSUTvisBcCkSYHAWGg1DmZZfuJ83fnSjmRYAUAoFrfRNXBKsXxUK38PNyvdxAKaGFtwiakTzSNhRekkG/luNoSZdasLn+RqMU+kNt3FJtRwtGV0dd8XHx19ODY01Px1RY3x605cMZxRd79cfEVS65jjqA93RXF+IBQMlxy9p6JJBERQm5XGy6uKtOakyxIMwKcObAMK+yOkP7gv7pohePW690iU+cm/fe/YhWg5xxx+cfK1f5ipFCfSIavVZYVf2ZZMvJoIh4P1ZmPnZHn9xjXHzjtMluJOLr4FRDIhJBj7MllbO/6nZzcWXwDwKABs++hfcPm55zZq5/hnPrnXBdOta+AFBnHHQi9YLTO0FG1lSU9FDKAdvNstLF0nA0+ACZo6ChxJC9TVcyo0tut7iZ78SmznBP/eUAHgzsNdwTOz9QcffXl1whTSPDQYeYjhxiabNFgJtFRQCAiwlQKDEMAAERAm5i4D3t4kFo+MRu7b1h1uT6829lZb7t3//IlLFrbuP1mvi3Mz01dNFzZun+jq+Z+jXV3eYrEQWqxVjlbW3X3lwA97hF/JFXlT3YoIE5d19bxwcHDwi+utyvXThaUvHJs8feq2vQeKAJA9elQ1X3h6smh739PFym7eWO7vOJa3vKoWgGSuyLbXjvf1ZkqPPPVPqBXjHQsVUCBAADKZXDQyXXdH+vteShx+128swMVvEzuuHk2WokL+xPacUC4tF2/cm/z2tXl5YneESjnD8EIkAoIRxEgEQxa7l8ZQviatT75/EF+7Zmfsk+m4edcbC+Uew8Jz7z8yfObie1dajZ3T62v/pAyZW280rj52bvI/PlXY+LvJpn3ZslJhGxLqQt7w9oc2GIAOAsdvp+YKKz2uFzxYcbzUYqPxqXvPToa3ro0fuaZlpFPHje78PRxNehes9KJbymTSszIZ7dXq/9mbn7nM0MFmeGUIADIUa4lczzOx8R2P9lx3I/82ZgZ+h5FNi8linV6r1L2RwZz46bt2mE9klnFN1dWHpop+QrEwe+NS55NUyKWM1wdz4af6s/FT1ZYTXSk0Phk1BaJW6KFMMlLduue9b74RndlY/+jZRvWyNd+La82XEjrbTXLnZTR0J4XZNCvCFhDSMUO6vSFzLm2FT6+1Gv/JAVMz0EOlRv3fhQ3jxR+c/sUzHz9wSANA8vCVS0Gt8aOg1bpcrcweIl8ZdFFRYiWTjhGL91aff/Gj1KyJTtXX0ZEhjYBjyTMymf1xUGvN/i68fieoEYimReLpuhv0zRbau3Kp8H3/4baxE6uF1sDxF88kbKdt7RkfUhO7Bgvb8uHVHqLg7hcWw2vl1kFD4LJcxnpsfFt06opeiwHgmZVF4+zq8qGpavnGou8nNRM0AQZ3VMtAbJaDW5bEBGYGEWAJChKGWR6IxZbTlrW63GzsmrVbe2xWYaEJYWkYy/X6XwzGE9OnCxvLB/LdrLaPcujl6CtOKXIXYole1OuDrLnTGBAGlNI1b2XjNj09N0q6o5t2VlAyYvGizGQflvHY84ltA/6fDOpf3jii/8+Ts3NehU8r4N1EWDw1Xf75hw/1Tr/T9fecWBHThdZA29ZH4iE6O74t9eTBoU5UBoC5YqF3qVn/UMl193vMxqbKCU0d0fpiPYu446EMgrYEKj2RcGEgGl8PFAcLjfqeVcfptxmhgCSi0AgLIsV6vxv4710oFn74r//jvztf+9KXE4WVdfP2ncO/yGV7JqXHfdpumpoAmBaEZe5xlzeuCAI7JElcWEyywgHl8vNuJnv6ydlFsfrGm6mvf/Wrzb/9+78P/mioAJCJh9obLf2i7fl7W7Z3bbmqZ+55eXHujsODbyvRao5H97+4kHA970pFMheOhL8/mI/NhNjRAPDg+bPxc8X1a8ue+56W5jSYaas4uCgkA2BIAJZgFTdlPWuaKwnDmpXCcJp+ML7Ubg6UfT+lNQwCwRCE4VhiIxsKHU9a1nyg1FUV155Jdufna7X6+wKtB+47Nxvan0mkY1aU2Qc0abC0YBVKu3SlKnwZFkJc5GwNC4FCbHFx7YaFavXSeCQ0q5gfALD6J4F66+F+/tazq6tGs/VUq+V+oqr15YakdQCti697drpuNgNMKKWORC15MhYxXxtMRBQAvLS8LM8X13Y3XPfPGr7awZoMAiMqhI4YVtXTvqWBkALDAlpRKVfTlrnWFYk2woalSrbdN9esj9YDlfVYmwF4swnJyAgDB/sG7k2Gwl9ZKZdG6oH7Od+xP5yLJx43pfFxwzIPaT8Qk/WWBcDkkAUohlACmF83oANoCkNsLjELAZKGoevtXQHTmGUa2jSMn7MhT/zJoALAp97dp+4/XTrx6nRhv6/09b7iN+49ufLGhw72MwA8+2aVziyWs7WWf3XIMlRP2nzmAweSF6DPVMqplUbr+oLtXGErFd0U1ZG1rHZ/MvMV27FZSuo1pMxbEEyA5yllrbXagzW3dklF+SkHGrT50+l+MaIg7pXmye54fG1udekqwwz1Vlx7j3KQj0XCi/l8zwlpWhuaWZgMCBVYVr28wyqtjxleECJN0FAAjI4nN6RuZ/Mrbq7rtCLhMBGINSzTnMzlu+t/Ep968bhlAl7DiT96brE6UWn4NyQSmAPQBIDTc7Vws60O2p7OpRLGI/3dyeXueEIDwLHZc+ZarXK45LdvdliFU4YsRIWo9sXi9RCJs3vS6WNGuKe8VC2/p9Bs3brm2IM15fU4Kuh1lAoHm0mA3GxMMmkISJ0QRmM4Fn21P544/erq0scXa5VwzAp7Zd/vDZjTWSt05a79e78+avvzGootzTA9P2pOvflestufIacwBh2IToPC73ihcKYU9Pbd5e3f/11tWU6gO91CKaUdi8dKf1KorIsS4Nj794fX10vG/U2XPl1teq8BeOIbjy2Iat0dsH11WEi5YJnGyzft6b6g4LQdrw8Kt/dHYumUYT2ltKpY0khBiJ6K3R6dqZT/qqHVYtFpf7LkuLtszdEATLzV/aSOhsvU0RPCQjp5K7yWsyIvR0zDmarVrl9z2tsdpaTp+uwSSIBiK4592DSMS8Z687+4bXxPFQCas9OivLbitZOpcd2qfly03bRiIgEfkJGAsrkXYz1d303u3z2pu7PIyBj/Ppx+X0vVAOxURPD+sa4XJxfq1y+vNO584s3i2TfX7GZAfJVSOp6MWA+MD6TKW5NO1sqRF6an3td0vevCUsZc5ZhF17Y8jaSvOaF0EKoxj7uBsmvaH/A1v6VhEjYbGwARIyaEypmhci4cncpGo+Wa7/ZM1WujdTfod0gLJkCzpo4kTVTzg/6K597R8tzJKcc5vjMc5vjodr107J55TqeOcSO5D45zpVDaIvjgbNeG7Ov/VrgnP5XqHWT8AeP3gkqiiwH4ADBVD8prZft/12vGV+YLrc9C4Z5A8btMUz493B07e92YqQFg2rPp5LmpfWv1+p8VbHuHZiZX636XWWqw2FJo1xy7WzAQbGmWW6onEQwAUSn9nGmudYfDS+lwpNX2fLVYrW0v+O5QPQiivIl/Uy2ESYSsFXazVmg6Isi27dbN55fmXgewAgDbbrvDnb7rWycC33lUe+4OXav3wopoMdD/g8T42JPdN9zs4Q8cxh86cWfS0PedWj23fSh599RS5QuBH0pJQY2udPipkb5424wkGADOLy71LdXKHy3Y7cPlILCYGUxvyb60WXJq1jCEQN4MsSTS7cAXzMwx06qnQ6GZfDiyEjEM0XC9+GKjMVRy3e5G4MddsKk37/lLvSSOS1kZiiV+EjXkpOO7N6/Xqh98vVa5e38q0wCA5LXX1NxXTx93GvYRp+3cILdtezU8MPT19PbhKv6IYfwxk2+9tE89PV8/Viy3DkyuOkcODaf/IZNNrF020gH6wvKqeWpp7oqVdvv2pq8yAgIK/FbpuTkCAjQxEkLwSDRe74nG15RWaSFEggStNlynUGo3e6u+318NVMpWHNLMstMgoU7Lht++UBEhkDZMbWmd057qbwVeAlr++9fnZ944U68+tyeZZjnQF4SKxdM6O/dt1+ShyOjOL6fHd8+Ex/bz/zeoAHDNcLL+vecW/9vhhDnRn4qeeP9E+kLltLG6avmttg4xnuwNhZ5hhtbv8IUKUwOBYDINYbQ8m5tCJqWQoUZg1zW0qjlOw9U8q0EyJSSSYqujQJudr7d/p4DBkEJIQ8icK7DXD9QgQSImZC0K6iLPNQF42U4AalePP/BQUC3NyWj8tfTBy4M/lsn/AyBxax0eqTsCAAAAAElFTkSuQmCC" /></a></p>
<p>Let’s study the axial vibration of a continuum bar with Young’s modulus E = 100 and the bar length L = 25.
Exact solutions for mode 1 are:</p>
<p><span class="math notranslate nohighlight">\(v(x, t) = v_0 \cos(\omega_1 t) \sin(\beta_1 x)\)</span></p>
<p><span class="math notranslate nohighlight">\(u(x, t) = \frac{v_0}{\omega_1} \sin(\omega_1 t) \sin(\beta_1 x)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\omega_1 = \frac{\pi}{2 L}\sqrt{E/\rho}\)</span> and <span class="math notranslate nohighlight">\(\beta_1 = \frac{\pi}{2L}\)</span>. The initial velocity is <span class="math notranslate nohighlight">\(v(x, 0) = v_0 \sin(\beta_1 x)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">axial_vibration_bar1d</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>

    <span class="c1"># Frequency of system mode 1</span>
    <span class="n">w1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>

    <span class="c1"># position and velocity in time</span>
    <span class="n">tt</span><span class="p">,</span> <span class="n">vt</span><span class="p">,</span> <span class="n">xt</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>
        <span class="n">vt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">w1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b1</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
        <span class="n">xt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v0</span> <span class="o">/</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">w1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b1</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
        <span class="n">tt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
    
    <span class="k">return</span> <span class="n">tt</span><span class="p">,</span> <span class="n">vt</span><span class="p">,</span> <span class="n">xt</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s now plot the analytical solution of a vibrating bar at the end of the bar <span class="math notranslate nohighlight">\(x = 1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Properties</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">25</span>

<span class="c1"># analytical solution at the end of the bar</span>
<span class="n">ta</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="n">xa</span> <span class="o">=</span> <span class="n">axial_vibration_bar1d</span><span class="p">(</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="p">,</span> <span class="n">rho</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">duration</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">v0</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">12.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytical&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;velocity (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/axial-vibration1d_5_0.png" src="_images/axial-vibration1d_5_0.png" />
</div>
</div>
<section id="mpm-axial-vibration-of-a-1d-bar">
<h2>MPM axial vibration of a 1D bar<a class="headerlink" href="#mpm-axial-vibration-of-a-1d-bar" title="Permalink to this headline">#</a></h2>
<p>The grid consists of 13 two-noded line elements (14 grid nodes) and 13 material points placed at the center of the elements are used. We study the axial vibration of a continuum bar with Young’s modulus E = 100 and the bar length L = 25. The time increment is chosen as <span class="math notranslate nohighlight">\(\Delta t = 0.1 \Delta x / c\)</span> where <span class="math notranslate nohighlight">\(\Delta x\)</span> denotes the nodal spacing. The initial velocity is given by: <span class="math notranslate nohighlight">\(v (x, 0) = v_0 \sin (\beta_1 x)\)</span>, where <span class="math notranslate nohighlight">\(v_0 = 0.1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># mass tolerance</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-12</span>

<span class="c1"># Domain</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">25</span>

<span class="c1"># Material properties</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Computational grid</span>

<span class="n">nelements</span> <span class="o">=</span> <span class="mi">13</span> <span class="c1"># number of elements</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">nelements</span> <span class="c1"># element length</span>

<span class="c1"># Create equally spaced nodes</span>
<span class="n">x_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">nelements</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">nnodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_n</span><span class="p">)</span>

<span class="c1"># Set-up a 2D array of elements with node ids</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nelements</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
    <span class="n">elements</span><span class="p">[</span><span class="n">nid</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">nid</span><span class="p">,</span> <span class="n">nid</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Loading conditions</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.1</span>             <span class="c1"># initial velocity</span>
<span class="n">c</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">rho</span><span class="p">)</span>  <span class="c1"># speed of sound</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># beta1</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c</span>          <span class="c1"># omega1</span>

<span class="c1"># Create material points at the center of each element</span>
<span class="n">nparticles</span> <span class="o">=</span> <span class="n">nelements</span>  <span class="c1"># number of particles</span>
<span class="c1"># Id of the particle in the central element</span>
<span class="n">pmid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">nparticles</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>

<span class="c1"># Material point properties</span>
<span class="n">x_p</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>       <span class="c1"># positions</span>
<span class="n">vol_p</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span>   <span class="c1"># volume</span>
<span class="n">mass_p</span>   <span class="o">=</span> <span class="n">vol_p</span> <span class="o">*</span> <span class="n">rho</span>                <span class="c1"># mass</span>
<span class="n">stress_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>       <span class="c1"># stress</span>
<span class="n">vel_p</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>       <span class="c1"># velocity</span>
<span class="n">vol0_p</span>   <span class="o">=</span> <span class="n">vol_p</span>                      <span class="c1"># initial volume</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
    <span class="c1"># Create particle at the center</span>
    <span class="n">x_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_n</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># set initial velocities</span>
    <span class="n">vel_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b1</span> <span class="o">*</span> <span class="n">x_p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># Time steps and duration</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">dt_crit</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">c</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">dt_crit</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">tt</span><span class="p">,</span> <span class="n">vt</span><span class="p">,</span> <span class="n">xt</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>
    <span class="c1"># reset nodal values</span>
    <span class="n">mass_n</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nnodes</span><span class="p">)</span>  <span class="c1"># mass</span>
    <span class="n">mom_n</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nnodes</span><span class="p">)</span>  <span class="c1"># momentum</span>
    <span class="n">fint_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nnodes</span><span class="p">)</span>  <span class="c1"># internal force</span>

    <span class="c1"># iterate through each element</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
        <span class="c1"># get nodal ids</span>
        <span class="n">nid1</span><span class="p">,</span> <span class="n">nid2</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        
        <span class="c1"># compute shape functions and derivatives</span>
        <span class="n">N1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">dN1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">dx</span>
        <span class="n">dN2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dx</span>

        <span class="c1"># map particle mass and momentum to nodes</span>
        <span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">N1</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="n">mom_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span>  <span class="o">+=</span> <span class="n">N1</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">vel_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="n">mom_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span>  <span class="o">+=</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">vel_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>

        <span class="c1"># compute nodal internal force</span>
        <span class="n">fint_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">vol_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">stress_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">dN1</span>
        <span class="n">fint_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">vol_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">stress_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">dN2</span>

    <span class="c1"># apply boundary conditions</span>
    <span class="n">mom_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Nodal velocity v = 0 in m * v at node 0.</span>
    <span class="n">fint_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Nodal force f = m * a, where a = 0 at node 0.</span>

    <span class="c1"># update nodal momentum</span>
    <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nnodes</span><span class="p">):</span>
        <span class="n">mom_n</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span> <span class="o">+=</span> <span class="n">fint_n</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c1"># update particle velocity position and stress</span>
    <span class="c1"># iterate through each element</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
        <span class="c1"># get nodal ids</span>
        <span class="n">nid1</span><span class="p">,</span> <span class="n">nid2</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        
        <span class="c1"># compute shape functions and derivatives</span>
        <span class="n">N1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">dN1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">dx</span>
        <span class="n">dN2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dx</span>

        <span class="c1"># compute particle velocity</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="n">vel_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">N1</span> <span class="o">*</span> <span class="n">fint_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">/</span> <span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="n">vel_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">fint_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span> <span class="o">/</span> <span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span>
        
        <span class="c1"># update particle position based on nodal momentum</span>
        <span class="n">x_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="n">N1</span> <span class="o">*</span> <span class="n">mom_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span><span class="o">/</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">+</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">mom_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span><span class="o">/</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">])</span>

        <span class="c1"># nodal velocity</span>
        <span class="n">nv1</span> <span class="o">=</span> <span class="n">mom_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span><span class="o">/</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span>
        <span class="n">nv2</span> <span class="o">=</span> <span class="n">mom_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span><span class="o">/</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span>

        <span class="c1"># Apply boundary condition</span>
        <span class="c1"># Rendundant, since momentum and forces are already set to zero</span>
        <span class="c1"># if (nid1 == 0): nv1 = 0</span>

        <span class="c1"># rate of strain increment</span>
        <span class="n">grad_v</span> <span class="o">=</span> <span class="n">dN1</span> <span class="o">*</span> <span class="n">nv1</span> <span class="o">+</span> <span class="n">dN2</span> <span class="o">*</span> <span class="n">nv2</span>
        <span class="c1"># particle dstrain</span>
        <span class="n">dstrain</span> <span class="o">=</span> <span class="n">grad_v</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="c1"># particle volume</span>
        <span class="n">vol_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">dstrain</span><span class="p">)</span>        
        <span class="c1"># update stress using linear elastic model</span>
        <span class="n">stress_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">E</span> <span class="o">*</span> <span class="n">dstrain</span>

    <span class="c1"># update plot params</span>
    <span class="n">tt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">vt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vel_p</span><span class="p">[</span><span class="n">pmid</span><span class="p">])</span>
    <span class="n">xt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="n">pmid</span><span class="p">])</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">dt</span>
</pre></div>
</div>
</div>
</div>
<section id="plot-results">
<h3>Plot results<a class="headerlink" href="#plot-results" title="Permalink to this headline">#</a></h3>
<blockquote>
<div><p>Velocity</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">vt</span><span class="p">,</span> <span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mpm&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;velocity (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/axial-vibration1d_9_0.png" src="_images/axial-vibration1d_9_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">xt</span> <span class="o">-</span> <span class="n">xt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mpm&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;displacement (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/axial-vibration1d_10_0.png" src="_images/axial-vibration1d_10_0.png" />
</div>
</div>
</section>
</section>
<section id="extending-it-to-support-multiple-material-points">
<h2>Extending it to support multiple material points<a class="headerlink" href="#extending-it-to-support-multiple-material-points" title="Permalink to this headline">#</a></h2>
<p>The code we have written is specific for a two-noded element with a single material point at the center of the element. The first step is to implement multiple material points in an element. Let’s start with particle generation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Material point properties</span>
<span class="n">x_p</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>       <span class="c1"># positions</span>
<span class="n">vol_p</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span>   <span class="c1"># volume</span>
<span class="n">mass_p</span>   <span class="o">=</span> <span class="n">vol_p</span> <span class="o">*</span> <span class="n">rho</span>                <span class="c1"># mass</span>
<span class="n">stress_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>       <span class="c1"># stress</span>
<span class="n">vel_p</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>       <span class="c1"># velocity</span>
<span class="n">vol0_p</span>   <span class="o">=</span> <span class="n">vol_p</span>                      <span class="c1"># initial volume</span>

<span class="c1"># Generate material points in cell</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
    <span class="c1"># Create particle at the center</span>
    <span class="n">x_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_n</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># set initial velocities</span>
    <span class="n">vel_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b1</span> <span class="o">*</span> <span class="n">x_p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<p>We are placing the particles at the center of the element, so the volume and mass of a particle is the volume and mass of the element. Let’s create a new variable called <code class="docutils literal notranslate"><span class="pre">ppc</span></code> (particles per cell) to support multiple material points (particles) per cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Material point properties</span>
<span class="c1"># Unchanged definitions</span>
<span class="n">x_p</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>            <span class="c1"># positions</span>
<span class="n">stress_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>            <span class="c1"># stress</span>
<span class="n">vel_p</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>            <span class="c1"># velocity</span>

<span class="c1"># New/updated variables</span>
<span class="n">ppc</span>      <span class="o">=</span> <span class="mi">1</span>                               <span class="c1"># particles / cell</span>
<span class="n">vol_p</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">ppc</span>  <span class="c1"># volume</span>

<span class="c1"># these variables haven&#39;t changed, they are updated based on vol</span>
<span class="n">mass_p</span>   <span class="o">=</span> <span class="n">vol_p</span> <span class="o">*</span> <span class="n">rho</span>                     <span class="c1"># mass</span>
<span class="n">vol0_p</span>   <span class="o">=</span> <span class="n">vol_p</span>                           <span class="c1"># initial volume</span>
</pre></div>
</div>
</div>
</div>
<section id="generating-material-points-in-a-cell">
<h3>Generating material points in a cell<a class="headerlink" href="#generating-material-points-in-a-cell" title="Permalink to this headline">#</a></h3>
<p>The current implementation generates a single material point per element.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_p</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>            <span class="c1"># positions</span>
<span class="c1"># Generate material points in cell</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
    <span class="c1"># Create particle at the center</span>
    <span class="n">x_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_n</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># set initial velocities</span>
    <span class="n">vel_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b1</span> <span class="o">*</span> <span class="n">x_p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Let’s plot the current mesh with a single material point per cell and see how it looks</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to plot mesh</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">def</span> <span class="nf">plot_mesh</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">x_n</span><span class="p">,</span> <span class="n">x_p</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">):</span>
    <span class="c1"># plt.cla()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">eid</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
        <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">element</span>
        <span class="n">n1x</span><span class="p">,</span> <span class="n">n2x</span> <span class="o">=</span> <span class="n">x_n</span><span class="p">[</span><span class="n">n1</span><span class="p">],</span> <span class="n">x_n</span><span class="p">[</span><span class="n">n2</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">n1x</span><span class="p">,</span><span class="n">n2x</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;--sk&#39;</span><span class="p">)</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="mf">0.005</span>
        
        <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">n1x</span> <span class="o">+</span> <span class="n">n2x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;e</span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">eid</span>, xy=(x,-1.5*dy),fontsize=fontsize)
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;n</span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">n1</span>, xy=(n1x,dy),fontsize=fontsize)
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;n</span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">n2</span>, xy=(n2x,dy),fontsize=fontsize)
        <span class="n">eid</span> <span class="o">=</span> <span class="n">eid</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">pid</span> <span class="o">=</span> <span class="mi">0</span>    
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_p</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;ob&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;p</span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">pid</span>, xy=(x, dy),fontsize=fontsize)
        <span class="n">pid</span> <span class="o">=</span> <span class="n">pid</span> <span class="o">+</span> <span class="mi">1</span>
 
    <span class="n">n1</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x_n</span><span class="p">[</span><span class="n">n1</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.04</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;n = node</span><span class="se">\n</span><span class="s2">p = material point</span><span class="se">\n</span><span class="s2">e = element&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Node position, $x_I$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mesh and Material Points&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_mesh</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">x_n</span><span class="p">,</span> <span class="n">x_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/axial-vibration1d_17_0.png" src="_images/axial-vibration1d_17_0.png" />
</div>
</div>
</section>
<section id="generating-multiple-material-points-per-cell">
<h3>Generating multiple material points per cell<a class="headerlink" href="#generating-multiple-material-points-per-cell" title="Permalink to this headline">#</a></h3>
<p>Let’s define a function that takes the number of particles per cell as an argument and return an array of positions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_particles</span><span class="p">(</span><span class="n">ppc</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">x_n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate particles in mesh</span>

<span class="sd">    Arguments:</span>
<span class="sd">    ppc: int</span>
<span class="sd">        number of particles per cell</span>

<span class="sd">    elements: List</span>
<span class="sd">        node ids of each element</span>
<span class="sd">    </span>
<span class="sd">    x_n: List</span>
<span class="sd">        nodal coordinates</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    x_p: List</span>
<span class="sd">        particle coordinates</span>
<span class="sd">    el_pids: List</span>
<span class="sd">        List of particle ids for each cell</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ppc = number of particles per cell</span>
    <span class="c1"># total number of particles</span>
    <span class="n">nparticles</span> <span class="o">=</span> <span class="n">nelements</span> <span class="o">*</span> <span class="n">ppc</span>
    <span class="c1"># positions</span>
    <span class="n">x_p</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>
    <span class="c1"># particle id</span>
    <span class="n">pid</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">eid</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Create a map of particle ids to each element</span>
    <span class="n">mpoints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># iterate through each element</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
        <span class="c1"># get nodal ids</span>
        <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">element</span>
        <span class="c1"># get nodal coordinates</span>
        <span class="n">n1x</span><span class="p">,</span> <span class="n">n2x</span> <span class="o">=</span> <span class="n">x_n</span><span class="p">[</span><span class="n">n1</span><span class="p">],</span> <span class="n">x_n</span><span class="p">[</span><span class="n">n2</span><span class="p">]</span>
        <span class="c1"># element length</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">n2x</span> <span class="o">-</span> <span class="n">n1x</span><span class="p">)</span>
        <span class="c1"># create an empty list of particles for each cell</span>
        <span class="n">particles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># generate particles uniformly across the element</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ppc</span><span class="p">):</span>
            <span class="c1"># first particle</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">particles</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
                <span class="n">x_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">=</span> <span class="n">n1x</span> <span class="o">+</span> <span class="n">dx</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ppc</span><span class="p">)</span>
            <span class="c1"># last particle</span>
            <span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">particles</span><span class="p">)</span><span class="o">==</span><span class="p">(</span><span class="n">ppc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)):</span>
                <span class="n">x_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">=</span> <span class="n">n2x</span> <span class="o">-</span> <span class="n">dx</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ppc</span><span class="p">)</span>
            <span class="c1"># mid particles</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">=</span> <span class="n">n1x</span> <span class="o">+</span> <span class="n">dx</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ppc</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">particles</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">ppc</span><span class="p">)</span>
            
            <span class="c1"># Append to particles</span>
            <span class="n">particles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
            <span class="c1"># particle id</span>
            <span class="n">pid</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c1"># Add pids to each element</span>
        <span class="n">mpoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">particles</span><span class="p">)</span>
        <span class="c1"># element id    </span>
        <span class="n">eid</span> <span class="o">+=</span> <span class="mi">1</span> 

    <span class="k">return</span> <span class="n">x_p</span><span class="p">,</span> <span class="n">mpoints</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>1 PPC</p>
</div></blockquote>
<p>Let us know generate a single material point per cell and plot to see if we get the same result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_p</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">generate_particles</span><span class="p">(</span><span class="n">ppc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">,</span> <span class="n">x_n</span><span class="o">=</span><span class="n">x_n</span><span class="p">)</span>
<span class="n">plot_mesh</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">x_n</span><span class="p">,</span> <span class="n">x_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/axial-vibration1d_21_0.png" src="_images/axial-vibration1d_21_0.png" />
</div>
</div>
<blockquote>
<div><p>2 PPC</p>
</div></blockquote>
<p>Let us know generate two material point per cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_p</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">generate_particles</span><span class="p">(</span><span class="n">ppc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">,</span> <span class="n">x_n</span><span class="o">=</span><span class="n">x_n</span><span class="p">)</span>
<span class="n">plot_mesh</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">x_n</span><span class="p">,</span> <span class="n">x_p</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/axial-vibration1d_23_0.png" src="_images/axial-vibration1d_23_0.png" />
</div>
</div>
</section>
<section id="iterate-over-particles">
<h3>Iterate over particles<a class="headerlink" href="#iterate-over-particles" title="Permalink to this headline">#</a></h3>
<p>Now that we have the ability to generate multiple material points per cell, we should also change how we loop over particle to map particle properties to node. Instead of mapping a single material property to the node, we need to map all particles’ properties in the element to the node.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># iterate through each element</span>
    <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
        <span class="c1"># get nodal ids</span>
        <span class="n">nid1</span><span class="p">,</span> <span class="n">nid2</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>

        <span class="c1"># compute shape functions and derivatives</span>
        <span class="n">N1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">dN1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">dx</span>
        <span class="n">dN2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dx</span>

        <span class="c1"># map particle mass and momentum to nodes</span>
        <span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">N1</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="n">mom_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span>  <span class="o">+=</span> <span class="n">N1</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">vel_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="n">mom_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span>  <span class="o">+=</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">vel_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>

        <span class="c1"># compute nodal internal force</span>
        <span class="n">fint_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">vol_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">stress_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">dN1</span>
        <span class="n">fint_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">vol_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">stress_p</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">*</span> <span class="n">dN2</span>
</pre></div>
</div>
<p>We need the associated particle ids for each element. We have the variable <code class="docutils literal notranslate"><span class="pre">mpoints</span></code> returned by <code class="docutils literal notranslate"><span class="pre">generate_particles()</span></code> function. The variable <code class="docutils literal notranslate"><span class="pre">mpoints</span></code> maps the particle ids to each element. Now we can iterate through all the particles in each element, instead of one particle per element.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># iterate through each element</span>
<span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
    <span class="c1"># get nodal ids</span>
    <span class="n">nid1</span><span class="p">,</span> <span class="n">nid2</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>    
    <span class="c1"># get particle ids associated with the element </span>
    <span class="n">mpts</span> <span class="o">=</span> <span class="n">mpoints</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>
    <span class="c1"># iterate through all particles in the element</span>
    <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">mpts</span><span class="p">:</span>
        <span class="c1"># compute shape functions and derivatives</span>
        <span class="n">N1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">dN1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">dx</span>
        <span class="n">dN2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dx</span>

        <span class="c1"># map particle mass and momentum to nodes</span>
        <span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">N1</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
        <span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
        <span class="n">mom_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span>  <span class="o">+=</span> <span class="n">N1</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">vel_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
        <span class="n">mom_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span>  <span class="o">+=</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">vel_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>

        <span class="c1"># compute nodal internal force</span>
        <span class="n">fint_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">vol_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">stress_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">dN1</span>
        <span class="n">fint_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">vol_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">stress_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">dN2</span>
</pre></div>
</div>
<p>Similarly, we will modify the mapping from node to particles.</p>
</section>
<section id="multiple-material-points-per-cell">
<h3>Multiple material points per cell<a class="headerlink" href="#multiple-material-points-per-cell" title="Permalink to this headline">#</a></h3>
<p>Full implementation to support multiple material points per cell. The following example shows how to perform the axial vibration in a 1D bar with 2 particles per cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># particles per cell</span>
<span class="n">ppc</span>      <span class="o">=</span> <span class="mi">2</span>                 

<span class="c1"># mass tolerance</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-12</span>

<span class="c1"># Domain</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">25</span>

<span class="c1"># Material properties</span>
<span class="n">E</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Computational grid</span>

<span class="n">nelements</span> <span class="o">=</span> <span class="mi">13</span> <span class="c1"># number of elements</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="n">nelements</span> <span class="c1"># element length</span>

<span class="c1"># Create equally spaced nodes</span>
<span class="n">x_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">nelements</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">nnodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_n</span><span class="p">)</span>

<span class="c1"># Set-up a 2D array of elements with node ids</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nelements</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
    <span class="n">elements</span><span class="p">[</span><span class="n">nid</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">nid</span><span class="p">,</span> <span class="n">nid</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Loading conditions</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.1</span>             <span class="c1"># initial velocity</span>
<span class="n">c</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">rho</span><span class="p">)</span>  <span class="c1"># speed of sound</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># beta1</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">c</span>          <span class="c1"># omega1</span>

<span class="c1"># Create material points </span>
<span class="n">nparticles</span> <span class="o">=</span> <span class="n">nelements</span> <span class="o">*</span> <span class="n">ppc</span>  <span class="c1"># number of particles</span>
<span class="c1"># Id of the particle in the central element</span>
<span class="n">pmid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">nparticles</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>

<span class="c1"># Material point properties</span>
<span class="n">x_p</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>       <span class="c1"># positions</span>
<span class="n">vol_p</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="o">/</span><span class="n">ppc</span> <span class="c1"># volume</span>
<span class="n">mass_p</span>   <span class="o">=</span> <span class="n">vol_p</span> <span class="o">*</span> <span class="n">rho</span>                <span class="c1"># mass</span>
<span class="n">stress_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>       <span class="c1"># stress</span>
<span class="n">vel_p</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>       <span class="c1"># velocity</span>
<span class="n">vol0_p</span>   <span class="o">=</span> <span class="n">vol_p</span>                      <span class="c1"># initial volume</span>
<span class="n">defg_p</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nparticles</span><span class="p">)</span>

<span class="c1"># Generate particles</span>
<span class="n">x_p</span><span class="p">,</span> <span class="n">mpoints</span> <span class="o">=</span> <span class="n">generate_particles</span><span class="p">(</span><span class="n">ppc</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">x_n</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nparticles</span><span class="p">):</span>
    <span class="c1"># set initial velocities</span>
    <span class="n">vel_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b1</span> <span class="o">*</span> <span class="n">x_p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># Time steps and duration</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">dt_crit</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">c</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">dt_crit</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">tt</span><span class="p">,</span> <span class="n">vt</span><span class="p">,</span> <span class="n">xt</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>
    <span class="c1"># reset nodal values</span>
    <span class="n">mass_n</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nnodes</span><span class="p">)</span>  <span class="c1"># mass</span>
    <span class="n">mom_n</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nnodes</span><span class="p">)</span>  <span class="c1"># momentum</span>
    <span class="n">fint_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nnodes</span><span class="p">)</span>  <span class="c1"># internal force</span>

    <span class="c1"># iterate through each element</span>
    <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
        <span class="c1"># get nodal ids</span>
        <span class="n">nid1</span><span class="p">,</span> <span class="n">nid2</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>
        <span class="c1"># get particle ids associated with the element </span>
        <span class="n">mpts</span> <span class="o">=</span> <span class="n">mpoints</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>
        <span class="c1"># iterate through all particles in the element</span>
        <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">mpts</span><span class="p">:</span>
            <span class="c1"># compute shape functions and derivatives</span>
            <span class="n">N1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
            <span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
            <span class="n">dN1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">dx</span>
            <span class="n">dN2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dx</span>

            <span class="c1"># map particle mass and momentum to nodes</span>
            <span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">N1</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
            <span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
            <span class="n">mom_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span>  <span class="o">+=</span> <span class="n">N1</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">vel_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
            <span class="n">mom_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span>  <span class="o">+=</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">mass_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">vel_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>

            <span class="c1"># compute nodal internal force</span>
            <span class="n">fint_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">vol_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">stress_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">dN1</span>
            <span class="n">fint_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">vol_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">stress_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*</span> <span class="n">dN2</span>

    <span class="c1"># apply boundary conditions</span>
    <span class="n">mom_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Nodal velocity v = 0 in m * v at node 0.</span>
    <span class="n">fint_n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Nodal force f = m * a, where a = 0 at node 0.</span>

    <span class="c1"># update nodal momentum</span>
    <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nnodes</span><span class="p">):</span>
        <span class="n">mom_n</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span> <span class="o">+=</span> <span class="n">fint_n</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c1"># update particle velocity position and stress</span>
    <span class="c1"># iterate through each element</span>
    <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
        <span class="c1"># get nodal ids</span>
        <span class="n">nid1</span><span class="p">,</span> <span class="n">nid2</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>
        <span class="c1"># get particle ids associated with the element </span>
        <span class="n">mpts</span> <span class="o">=</span> <span class="n">mpoints</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>
        <span class="c1"># iterate through all particles in the element</span>
        <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">mpts</span><span class="p">:</span>
            <span class="c1"># compute shape functions and derivatives</span>
            <span class="n">N1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
            <span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span>
            <span class="n">dN1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">dx</span>
            <span class="n">dN2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dx</span>

            <span class="c1"># compute particle velocity</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="n">vel_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">N1</span> <span class="o">*</span> <span class="n">fint_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">/</span> <span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="n">vel_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">fint_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span> <span class="o">/</span> <span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span>
            
            <span class="c1"># update particle position based on nodal momentum</span>
            <span class="n">x_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="n">N1</span> <span class="o">*</span> <span class="n">mom_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span><span class="o">/</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span> <span class="o">+</span> <span class="n">N2</span> <span class="o">*</span> <span class="n">mom_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span><span class="o">/</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">])</span>

            <span class="c1"># nodal velocity</span>
            <span class="n">nv1</span> <span class="o">=</span> <span class="n">mom_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span><span class="o">/</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span>
            <span class="n">nv2</span> <span class="o">=</span> <span class="n">mom_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span><span class="o">/</span><span class="n">mass_n</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span>

            <span class="c1"># Apply boundary condition</span>
            <span class="c1"># Rendundant, since momentum and forces are already set to zero</span>
            <span class="c1"># if (nid1 == 0): nv1 = 0</span>

            <span class="c1"># rate of strain increment</span>
            <span class="n">grad_v</span> <span class="o">=</span> <span class="n">dN1</span> <span class="o">*</span> <span class="n">nv1</span> <span class="o">+</span> <span class="n">dN2</span> <span class="o">*</span> <span class="n">nv2</span>
            <span class="c1"># particle dstrain</span>
            <span class="n">dstrain</span> <span class="o">=</span> <span class="n">grad_v</span> <span class="o">*</span> <span class="n">dt</span>
            <span class="c1"># particle volume</span>
            <span class="n">vol_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">dstrain</span><span class="p">)</span>        
            <span class="c1"># update stress using linear elastic model</span>
            <span class="n">stress_p</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">+=</span> <span class="n">E</span> <span class="o">*</span> <span class="n">dstrain</span>

    <span class="c1"># update plot params</span>
    <span class="n">tt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">vt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vel_p</span><span class="p">[</span><span class="n">pmid</span><span class="p">])</span>
    <span class="n">xt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_p</span><span class="p">[</span><span class="n">pmid</span><span class="p">])</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">dt</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Plot velocity at the center of the bar</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">va</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">vt</span><span class="p">,</span> <span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mpm&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;velocity (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/axial-vibration1d_28_0.png" src="_images/axial-vibration1d_28_0.png" />
</div>
</div>
<blockquote>
<div><p>Plot displacement at the center of the bar</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">xa</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">xt</span><span class="o">-</span><span class="n">xt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;ob&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mpm&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;displacement (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/axial-vibration1d_30_0.png" src="_images/axial-vibration1d_30_0.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "xai"
        },
        kernelOptions: {
            kernelName: "xai",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'xai'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="point-axial-vibration1d.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">1D vibration of a single material point</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="mpm-code.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Coding 1D MPM</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Krishna Kumar<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>